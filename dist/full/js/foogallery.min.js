/*
* FooGallery - The Most Intuitive and Extensible Gallery Creation and Management Tool Ever Created for WordPress
* @version 1.0.4
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/

!function(a,b){b.$=a}(jQuery,window.FooGallery=window.FooGallery||{}),function(a){if(!a)return void console.warn("jQuery must be included in the page prior to the FooGallery.utils library.");var b={$:a,version:"0.0.5"};b.versionCompare=function(a,b){function c(a){for(var b=a.split("."),c=0,d=b.length;c<d;c++)b[c]=parseInt(b[c]),isNaN(b[c])&&(b[c]=0);return b}if(!/[\d.]/.test(a)||!/[\d.]/.test(b))return NaN;for(var d=c(a),e=c(b);d.length<e.length;)d.push(0);for(;e.length<d.length;)e.push(0);for(var f=0;f<d.length;++f){if(e.length==f)return 1;if(d[f]!=e[f])return d[f]>e[f]?1:-1}return d.length!=e.length?-1:0},!function(){try{return!!window.FooGallery.utils}catch(a){return!1}}()?window.FooGallery.utils=b:b.versionCompare(b.version,window.FooGallery.utils.version)>0?(console.warn("An older version of FooGallery.utils ("+window.FooGallery.utils.version+") already exists in the page, version "+b.version+" will override it."),window.FooGallery.utils=b):console.warn("A newer version of FooGallery.utils ("+window.FooGallery.utils.version+") already exists in the page, version "+b.version+" will not register itself.")}(jQuery),function(a,b){"0.0.5"===b.version&&(b.is={},b.is.array=function(a){return"[object Array]"===Object.prototype.toString.call(a)},b.is.boolean=function(a){return"[object Boolean]"===Object.prototype.toString.call(a)},b.is.element=function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:!!a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName},b.is.empty=function(a){if(b.is.undef(a)||null===a)return!0;if(b.is.number(a)&&0==a)return!0;if(b.is.boolean(a)&&!1===a)return!0;if(b.is.string(a)&&0===a.length)return!0;if(b.is.array(a)&&0===a.length)return!0;if(b.is.jq(a)&&0===a.length)return!0;if(b.is.hash(a)){for(var c in a)if(a.hasOwnProperty(c))return!1;return!0}return!1},b.is.error=function(a){return"[object Error]"===Object.prototype.toString.call(a)},b.is.fn=function(a){return a===window.alert||"[object Function]"===Object.prototype.toString.call(a)},b.is.hash=function(a){return b.is.object(a)&&a.constructor===Object&&!a.nodeType&&!a.setInterval},b.is.jq=function(c){return!b.is.undef(a)&&c instanceof a},b.is.number=function(a){return"[object Number]"===Object.prototype.toString.call(a)&&!isNaN(a)},b.is.object=function(a){return"[object Object]"===Object.prototype.toString.call(a)&&!b.is.undef(a)&&null!==a},b.is.promise=function(a){return b.is.object(a)&&b.is.fn(a.then)&&b.is.fn(a.promise)},b.is.size=function(a){return!!(b.is.string(a)&&!b.is.empty(a)||b.is.number(a))&&/^(auto|none|(?:[\d\.]*)+?(?:%|px|mm|q|cm|in|pt|pc|em|ex|ch|rem|vh|vw|vmin|vmax)?)$/.test(a)},b.is.string=function(a){return"[object String]"===Object.prototype.toString.call(a)},b.is.undef=function(a){return void 0===a})}(FooGallery.utils.$,FooGallery.utils),function(a,b,c){if("0.0.5"===b.version){b.fn={};var d=Function.prototype.toString;b.fn.CONTAINS_SUPER=/xyz/.test(d.call(function(){xyz}))?/\b_super\b/:/.*/,b.fn.addOrOverride=function(a,e,f){if(c.object(a)&&c.string(e)&&!c.empty(e)&&c.fn(f)){var g=a[e],h=c.fn(g)&&b.fn.CONTAINS_SUPER.test(d.call(f));a[e]=h?function(a,b){return function(){var c=this._super;this._super=a;var d=b.apply(this,arguments);return this._super=c,d}}(g,f):f}},b.fn.apply=function(a,b){function d(){return a.apply(this,b)}return b=c.array(b)?b:[],d.prototype=a.prototype,new d},b.fn.arg2arr=function(a){return Array.prototype.slice.call(a)},b.fn.check=function(d,e,f,g){function h(a){return function(){return a.apply(d,arguments)}}return f=c.fn(f)?f:a.noop,d=c.object(d)?d:window,e=c.string(e)?b.fn.fetch(e,g):e,h(c.fn(e)?e:f)},b.fn.fetch=function(b,d){return!c.string(b)||c.empty(b)?null:(d=c.object(d)?d:window,a.each(b.split("."),function(a,b){if(!d[b])return!1;d=d[b]}),c.fn(d)?d:null)},b.fn.enqueue=function(d,e,f,g){function h(a,b){try{return n.push(a),b.apply(a,i)}catch(a){return j.reject(a,n),j}}var i=b.fn.arg2arr(arguments),j=a.Deferred(),k=a.Deferred(),l=k.promise(),m=[],n=[],o=!0;return d=i.shift(),e=i.shift(),a.each(d,function(a,d){c.fn(d[e])&&(l=l.then(function(){if(!o){var a=b.fn.arg2arr(arguments);m.push(a)}return o=!1,h(d,d[e])}))}),l.then(function(){if(!o){var a=b.fn.arg2arr(arguments);m.push(a)}o=!1,j.resolve(m)}),l.fail(function(){var a=b.fn.arg2arr(arguments);a.push(n),j.reject.apply(j,a)}),k.resolve(),j.promise()},b.fn.when=function(b){if(!c.array(b)||c.empty(b))return a.when();for(var d=a.Deferred(),e=[],f=b.length,g=0;g<b.length;g++)b[g].then(function(a){e.push(a)}).always(function(){--f||d.resolve(e)});return d.promise()},b.fn.rejectWith=function(c,d){var e=a.Deferred(),f=b.fn.arg2arr(arguments);return e.reject.apply(e,f).promise()},b.fn.resolveWith=function(c,d){var e=a.Deferred(),f=b.fn.arg2arr(arguments);return e.resolve.apply(e,f).promise()},b.fn.resolved=a.Deferred().resolve().promise(),b.fn.rejected=a.Deferred().reject().promise()}}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is),function(a,b){if("0.0.5"===a.version){a.url={};var c=document.createElement("a");a.url.parts=function(a){return c.href=a,{hash:c.hash,host:c.host,hostname:c.hostname,href:c.href,origin:c.origin,pathname:c.pathname,port:c.port,protocol:c.protocol,search:c.search}},a.url.full=function(a){return!b.string(a)||b.empty(a)?null:(c.href=a,c.href)},a.url.param=function(a,c,d){if(!b.string(a)||b.empty(a)||!b.string(c)||b.empty(c))return a;var e,f,g,h;return b.undef(d)?(e=new RegExp("[?|&]"+c+"=([^&;]+?)(&|#|;|$)"),f=e.exec(a)||[,""],g=f[1].replace(/\+/g,"%20"),b.string(g)&&!b.empty(g)?decodeURIComponent(g):null):(""===d||null===d?(e=new RegExp("^([^#]*?)(([^#]*)&)?"+c+"(=[^&#]*)?(&|#|$)"),g=a.replace(e,"$1$3$5").replace(/^([^#]*)((\?)&|\?(#|$))/,"$1$3$4")):(e=new RegExp("([?&])"+c+"[^&]*"),h=c+"="+encodeURIComponent(d),(g=a.replace(e,"$1"+h))!==a||e.test(g)||(g+="&"+h)),g)}}}(FooGallery.utils,FooGallery.utils.is),function(a,b,c){"0.0.5"===a.version&&(a.str={},a.str.camel=function(a){return b.empty(a)?a:a.toUpperCase()===a?a.toLowerCase():a.replace(/^([A-Z])|[-\s_]+(\w)/g,function(a,c,d){return b.string(d)?d.toUpperCase():c.toLowerCase()})},a.str.contains=function(a,c,d){return!(!b.string(a)||b.empty(a)||!b.string(c)||b.empty(c))&&(c.length<=a.length&&-1!==(d?a.toUpperCase().indexOf(c.toUpperCase()):a.indexOf(c)))},a.str.containsWord=function(a,c,d){if(!b.string(a)||b.empty(a)||!b.string(c)||b.empty(c)||a.length<c.length)return!1;for(var e=a.split(/\W/),f=0,g=e.length;f<g;f++)if(d?e[f].toUpperCase()==c.toUpperCase():e[f]==c)return!0;return!1},a.str.endsWith=function(a,c){return!b.string(a)||b.empty(a)||!b.string(c)||b.empty(c)?a==c:a.slice(a.length-c.length)==c},a.str.escapeRegExp=function(a){return b.empty(a)?a:a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},a.str.fnv1a=function(a){if(!b.string(a)||b.empty(a))return null;var c,d,e=2166136261;for(c=0,d=a.length;c<d;c++)e^=a.charCodeAt(c),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0},a.str.from=function(c,d){return!b.string(c)||b.empty(c)||!b.string(d)||b.empty(d)?null:a.str.contains(c,d)?c.substring(c.indexOf(d)+d.length):null},a.str.join=function(d,e,f){if(!b.string(d)||!b.string(e))return null;var g=c.arg2arr(arguments);d=g.shift();var h,i,j=g.shift();for(h=0,i=g.length;h<i;h++)e=g[h],b.empty(e)||(a.str.endsWith(j,d)&&(j=j.slice(0,j.length-d.length)),a.str.startsWith(e,d)&&(e=e.slice(d.length)),j+=d+e);return j},a.str.startsWith=function(a,c){return!b.empty(a)&&!b.empty(c)&&a.slice(0,c.length)==c},a.str.until=function(c,d){return b.empty(c)||b.empty(d)?c:a.str.contains(c,d)?c.substring(0,c.indexOf(d)):c},a.str.format=function(a,d,e){var f=c.arg2arr(arguments);if(a=f.shift(),b.empty(a)||b.empty(f))return a;1===f.length&&(b.array(f[0])||b.object(f[0]))&&(f=f[0]);for(var g in f)a=a.replace(new RegExp("\\{"+g+"\\}","gi"),f[g]);return a})}(FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn),function(a,b,c,d,e){if("0.0.5"===b.version){b.obj={};var f=function(){};b.obj.create=function(a){if(!c.object(a))throw TypeError("Argument must be an object");f.prototype=a;var b=new f;return f.prototype=null,b},b.obj.extend=function(e,f,g){e=c.object(e)?e:{};var h=d.arg2arr(arguments);return h.shift(),a.each(h,function(a,c){b.obj.merge(e,c)}),e},b.obj.merge=function(a,d){a=c.object(a)?a:{},d=c.object(d)?d:{};for(var e in d)d.hasOwnProperty(e)&&(c.object(d[e])?(a[e]=c.object(a[e])?a[e]:{},b.obj.merge(a[e],d[e])):c.array(d[e])?a[e]=d[e].slice():a[e]=d[e]);return a},b.obj.mergeValid=function(d,e,f,g){if(!c.hash(f)||!c.hash(e))return d;e=c.hash(e)?e:{},g=c.hash(g)?g:{};var h,i,j;for(h in e)e.hasOwnProperty(h)&&c.fn(e[h])&&(i=c.array(g[h])?g[h]:c.string(g[h])?[g[h]]:[h],a.each(i,function(a,g){if(j=b.obj.prop(f,g),!c.undef(j))return e[h](j)?(b.obj.prop(d,h,j),!1):void 0}));return d},b.obj.prop=function(b,d,f){if(c.object(b)&&!c.empty(d)){var g,h;if(c.undef(f))return e.contains(d,".")?(g=d.split("."),h=g.length-1,a.each(g,function(a,d){if(a===h)f=b[d];else{if(!c.hash(b[d]))return!1;b=b[d]}})):c.undef(b[d])||(f=b[d]),f;e.contains(d,".")?(g=d.split("."),h=g.length-1,a.each(g,function(a,d){a===h?b[d]=f:b=c.hash(b[d])?b[d]:b[d]={}})):c.undef(b[d])||(b[d]=f)}}}}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.str),function(a,b,c){if("0.0.5"===b.version){b.ready=function(a){function c(){try{a.call(window,b.$)}catch(a){console.error(a)}}(Function("/*@cc_on return true@*/")()?"complete"===document.readyState:"loading"!==document.readyState)?c():document.addEventListener("DOMContentLoaded",c,!1)};var d=0;b.uniqueId=function(a,b){var e=a.attr("id");return c.empty(e)&&(b=c.string(b)&&!c.empty(b)?b:"uid-",e=b+ ++d,a.attr("id",e).data("__uniqueId__",!0)),e},b.removeUniqueId=function(a){a.data("__uniqueId__")&&a.removeAttr("id").removeData("__uniqueId__")}}}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is),function(a,b,c){if("0.0.5"===b.version){b.transition={};var d=document.createElement("div");b.transition.supported=function(a){var b=a.style;return c.string(b.transition)||c.string(b.WebkitTransition)||c.string(b.MozTransition)||c.string(b.msTransition)||c.string(b.OTransition)}(d),b.transition.end=function(a){var b=a.style;return c.string(b.transition)?"transitionend":c.string(b.WebkitTransition)?"webkitTransitionEnd":c.string(b.MozTransition)?"transitionend":c.string(b.msTransition)?"msTransitionEnd":c.string(b.OTransition)?"oTransitionEnd":null}(d),b.transition.duration=function(a,b){if(b=c.number(b)?b:0,!c.jq(a))return b;var d=a.css("transition-duration");if(/^([\d\.]*)+?(ms|s)$/i.test(d)){var e=d.match(/^([\d\.]*)+?(ms|s)$/i),f=parseFloat(e[1]);return"s"===e[2].toLowerCase()&&(f*=1e3),f}return b},b.transition.start=function(d,e,f,g){var h=a.Deferred();if(d=d.first(),b.transition.supported){var i=d.data("transition_safety");c.hash(i)&&c.number(i.timer)&&(clearTimeout(i.timer),d.removeData("transition_safety").off(b.transition.end+".utils"),i.deferred.reject()),g=c.number(g)?g:b.transition.duration(d)+50,i={deferred:h,timer:setTimeout(function(){d.removeData("transition_safety").off(b.transition.end+".utils"),h.resolve()},g)},d.data("transition_safety",i),d.on(b.transition.end+".utils",function(a){d.is(a.target)&&(clearTimeout(i.timer),d.removeData("transition_safety").off(b.transition.end+".utils"),h.resolve())})}return setTimeout(function(){d.toggleClass(e,f),b.transition.supported||h.resolve()},20),h.promise()}}}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d,e){"0.0.5"===b.version&&(b.Class=function(){},b.Class.extend=function(a){function f(){if(!c.fn(this.construct))throw new SyntaxError('FooGallery.utils.Class objects must be constructed with the "new" keyword.');this.construct.apply(this,arguments)}a=c.hash(a)?a:{};var g=d.create(this.prototype);for(var h in a)a.hasOwnProperty(h)&&e.addOrOverride(g,h,a[h]);return g.construct=c.fn(g.construct)?g.construct:function(){},f.prototype=g,f.prototype.constructor=c.fn(g.__ctor__)?g.__ctor__:f,f.extend=b.Class.extend,f.override=b.Class.override,f},b.Class.override=function(a,b){e.addOrOverride(this.prototype,a,b)})}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.obj,FooGallery.utils.fn),function(a,b,c){if("0.0.5"===b.version){b.Bounds=b.Class.extend({construct:function(){var a=this;a.top=0,a.right=0,a.bottom=0,a.left=0,a.width=0,a.height=0},inflate:function(a){var b=this;return c.number(a)&&(b.top-=a,b.right+=a,b.bottom+=a,b.left-=a,b.width+=2*a,b.height+=2*a),b},intersects:function(a){var b=this;return b.left<=a.right&&a.left<=b.right&&b.top<=a.bottom&&a.top<=b.bottom}});var d;b.getViewportBounds=function(c){d||(d=a(window));var e=new b.Bounds;return e.top=d.scrollTop(),e.left=d.scrollLeft(),e.width=d.width(),e.height=d.height(),e.right=e.left+e.width,e.bottom=e.top+e.height,e.inflate(c),e},b.getElementBounds=function(d){c.jq(d)||(d=a(d));var e=new b.Bounds;if(0!==d.length){var f=d.offset();e.top=f.top,e.left=f.left,e.width=d.width(),e.height=d.height()}return e.right=e.left+e.width,e.bottom=e.top+e.height,e}}}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){"0.0.5"===b.version&&(b.Factory=b.Class.extend({construct:function(){this.registered={}},contains:function(a){return!c.undef(this.registered[a])},load:function(b,e,f){var g,h,i=this,j=d.arg2arr(arguments),k=[],l=[];b=j.shift()||{};for(g in i.registered)if(i.registered.hasOwnProperty(g)){var m=i.registered[g];b.hasOwnProperty(g)&&(h=b[g],c.string(h)&&(h=d.fetch(b[g])),c.fn(h)&&(m={name:g,klass:h,priority:i.registered[g].priority})),k.push(m)}for(g in b)b.hasOwnProperty(g)&&!i.registered.hasOwnProperty(g)&&(h=b[g],c.string(h)&&(h=d.fetch(b[g])),c.fn(h)&&k.push({name:g,klass:h,priority:0}));return k.sort(function(a,b){return b.priority-a.priority}),a.each(k,function(a,b){c.fn(b.klass)&&l.push(d.apply(b.klass,j))}),l},make:function(a,b,e){var f,g=this,h=d.arg2arr(arguments);return a=h.shift(),f=g.registered[a],c.hash(f)&&c.fn(f.klass)?d.apply(f.klass,h):null},names:function(b){b=!!c.boolean(b)&&b;var d,e=[];if(b){var f=[];for(d in this.registered)this.registered.hasOwnProperty(d)&&f.push(this.registered[d]);f.sort(function(a,b){return b.priority-a.priority}),a.each(f,function(a,b){e.push(b.name)})}else for(d in this.registered)this.registered.hasOwnProperty(d)&&e.push(d);return e},register:function(a,b,d){if(!c.string(a)||c.empty(a)||!c.fn(b))return!1;d=c.number(d)?d:0;var e=this.registered[a];return this.registered[a]={name:a,klass:b,priority:c.undef(e)?d:e.priority},!0}}))}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn),function(a,b,c){"0.0.5"===a.version&&(a.Debugger=a.Class.extend({construct:function(a){this.key=a,this.enabled=!!localStorage.getItem(this.key)},enable:function(){this.enabled=!0,localStorage.setItem(this.key,this.enabled)},disable:function(){this.enabled=!1,localStorage.removeItem(this.key)},log:function(a,c){this.enabled&&console.log.apply(console,b.arg2arr(arguments))},logf:function(a,d,e){if(this.enabled){var f=b.arg2arr(arguments);a=f.shift(),d=f.shift(),f.unshift(c.format(a,d)),this.log.apply(this,f)}}}))}(FooGallery.utils,FooGallery.utils.fn,FooGallery.utils.str),function(a,b,c){"0.0.5"===b.version&&(b.Throttle=b.Class.extend({construct:function(a){this.id=null,this.active=!1,this.idle=c.number(a)?a:0},limit:function(a){if(c.fn(a)){this.clear();var b=this;this.active=!0,this.id=setTimeout(function(){b.active=!1,b.id=null,a()},this.idle)}},clear:function(){c.number(this.id)&&(clearTimeout(this.id),this.active=!1,this.id=null)}}))}(FooGallery.utils.$,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d,e){b.debug=new c.Debugger("__FooGallery__"),c.selectify=function(b){if(d.hash(b)){var e,f={};for(var g in b)b.hasOwnProperty(g)&&(e=c.selectify(b[g]))&&(f[g]=e);return f}return d.string(b)||d.array(b)?(d.string(b)&&(b=[b]),a.map(b,function(a){return d.string(a)?"."+a.split(/\s/g).join("."):null}).join(",")):null},b.emptyImage="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",b.dataTemplate="__FooGallery__",b.dataItem="__FooGalleryItem__",b.init=function(a,c){return b.template.make(a,c).initialize()},b.initAll=function(c){return e.when(a(".foogallery").map(function(a,d){return b.init(c,d)}).get())},b.parseSrc=function(b,c,e,f,g,h){if(!d.string(b))return null;if(!d.string(f))return b;var i=a.map(f.replace(/(\s[\d.]+[whx]),/g,"$1 @,@ ").split(" @,@ "),function(a){return{url:/^\s*(\S*)/.exec(a)[1],w:parseFloat((/\S\s+(\d+)w/.exec(a)||[0,1/0])[1]),h:parseFloat((/\S\s+(\d+)h/.exec(a)||[0,1/0])[1]),x:parseFloat((/\S\s+([\d.]+)x/.exec(a)||[0,1])[1])}});if(!i.length)return b;i.unshift({url:b,w:i[0].w!==1/0&&i[0].h===1/0?c:1/0,h:i[0].h!==1/0&&i[0].w===1/0?e:1/0,x:1});var j,k=window.devicePixelRatio||1,l={w:g*k,h:h*k,x:k};for(j in l)l.hasOwnProperty(j)&&(i=a.grep(i,function(a,b){return function(c){return c[a]>=l[a]||c[a]===b}}(j,Math.max.apply(null,a.map(i,function(a){return a[j]})))));for(j in l)l.hasOwnProperty(j)&&(i=a.grep(i,function(a,b){return function(c){return c[a]===b}}(j,Math.min.apply(null,a.map(i,function(a){return a[j]})))));return i[0].url},a.fn.foogallery=function(c,e){return this.filter(".foogallery").each(function(f,g){if(d.string(c)){var h=a.data(g,b.dataTemplate);if(h instanceof b.Template)switch(c){case"layout":return void h.layout();case"destroy":return void h.destroy()}}else b.template.make(c,g).initialize().then(function(a){d.fn(e)&&e(a)})})},a(function(){a('[id^="foogallery-"]').foogallery()})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn),function(a,b,c,d,e,f){b.TemplateFactory=c.Factory.extend({construct:function(){this.registered={}},register:function(a,b,c,e,f,g){var h=this,i=h._super(a,b,g);if(i){var j=h.registered;j[a].opt=d.hash(c)?c:{},j[a].cls=d.hash(e)?e:{},j[a].il8n=d.hash(f)?f:{}}return i},make:function(b,c){c=d.jq(c)?c:a(c),b=f.merge(b,c.data("foogallery"));var e=this,g=e.type(b,c);return e.contains(g)?(b=e.options(g,b),e._super(g,b,c)):null},type:function(b,e){e=d.jq(e)?e:a(e);var f=this,g=d.hash(b)&&d.hash(b)&&d.string(b.type)&&f.contains(b.type)?b.type:"core";if("core"===g&&e.length>0)for(var h=f.registered,i=f.names(!0),j=0,k=i.length;j<k;j++)if(h.hasOwnProperty(i[j])){var l=i[j],m=h[l].cls;if(d.string(m.container)){var n=c.selectify(m.container);if(e.is(n)){g=i[j];break}}}return g},configure:function(a,b,c,d){var e=this;if(e.contains(a)){var g=e.registered;f.extend(g[a].opt,b),f.extend(g[a].cls,c),f.extend(g[a].il8n,d)}},options:function(a,c){c=d.hash(c)?c:{};var e=this,g=e.registered,h=g.core.opt,i=g.core.cls,j=g.core.il8n;return c=b.paging.merge(c),"core"!==a&&e.contains(a)?(c=f.extend({},h,g[a].opt,c),c.cls=f.extend({},i,g[a].cls,c.cls),c.il8n=f.extend({},j,g[a].il8n,c.il8n)):(c=f.extend({},h,c),c.cls=f.extend({},i,c.cls),c.il8n=f.extend({},j,c.il8n)),c}}),b.template=new b.TemplateFactory}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.obj),function(a,b,c,d,e){a.PagingFactory=b.Factory.extend({construct:function(){this.registered={}},register:function(a,b,d,e,f,g,h){var i=this,j=i._super(a,b,h);if(j){var k=i.registered;k[a].ctrl=c.fn(d)?d:null,k[a].opt=c.hash(e)?e:{},k[a].cls=c.hash(f)?f:{},k[a].il8n=c.hash(g)?g:{}}return j},type:function(a){var b,d=this;return c.hash(a)&&c.hash(b=a.paging)&&c.string(b.type)&&d.contains(b.type)?b.type:null},merge:function(a){a=c.hash(a)?a:{};var b=this,d=b.type(a),f=b.registered,g=f.default.opt,h=f.default.cls,i=f.default.il8n,j=c.hash(a.paging)?a.paging:{},k=c.hash(a.cls)&&c.hash(a.cls.paging)?a.cls.paging:{},l=c.hash(a.il8n)&&c.hash(a.il8n.paging)?a.il8n.paging:{};return"default"!==d&&b.contains(d)?(a.paging=e.extend({},g,f[d].opt,j,{type:d}),a.cls=e.extend({},{paging:h},{paging:f[d].cls},{paging:k}),a.il8n=e.extend({},{paging:i},{paging:f[d].il8n},{paging:l})):(a.paging=e.extend({},g,j,{type:d}),a.cls=e.extend({},{paging:h},{paging:k}),a.il8n=e.extend({},{paging:i},{paging:l})),a},configure:function(a,b,c,d){var f=this;if(f.contains(a)){var g=f.registered;e.extend(g[a].opt,b),e.extend(g[a].cls,c),e.extend(g[a].il8n,d)}},options:function(a,b){b=c.hash(b)?b:{};var d=this,f=d.registered,g=f.default.opt,h=f.default.cls,i=f.default.il8n,j=c.hash(b.paging)?b.paging:{},k=c.hash(b.cls)&&c.hash(b.cls.paging)?b.cls.paging:{},l=c.hash(b.il8n)&&c.hash(b.il8n.paging)?b.il8n.paging:{};return"default"!==a&&d.contains(a)?(b.paging=e.extend({},g,f[a].opt,j,{type:a}),b.cls=e.extend({},{paging:h},{paging:f[a].cls},{paging:k}),b.il8n=e.extend({},{paging:i},{paging:f[a].il8n},{paging:l})):(b.paging=e.extend({},g,j,{type:a}),b.cls=e.extend({},{paging:h},{paging:k}),b.il8n=e.extend({},{paging:i},{paging:l})),b},hasCtrl:function(a){var b=this,d=b.registered[a];return c.hash(d)&&c.fn(d.ctrl)},makeCtrl:function(a,b,d,e){var f=this,g=f.registered[a];return c.hash(g)&&c.fn(g.ctrl)?new g.ctrl(b,d,e):null}}),a.paging=new a.PagingFactory}(FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.obj),function(a,b,c,d,e,f){b.Template=c.Class.extend({construct:function(e,f){var g=this;g.$el=d.jq(f)?f:a(f),g.opt=e,g.template=e.template,g.id=g.$el.prop("id")||e.id,g.createdSelf=!1,g.cls=e.cls,g.il8n=e.il8n,g.sel=c.selectify(g.cls),g.items=b.components.make("items",g),g.pages=b.paging.make(e.paging.type,g),g.state=b.components.make("state",g),g._throttle=new c.Throttle(g.opt.throttle),g._initialize=null,g.initializing=!1,g.initialized=!1,g.destroying=!1,g.destroyed=!1},initialize:function(c){var f=this;return d.promise(f._initialize)?f._initialize:(c=d.jq(c)?c:a(c),f._initialize=a.Deferred(function(g){if(f.initializing=!0,0===c.length&&0===f.$el.parent().length)return void g.reject("A parent element is required.");0===f.$el.length&&(f.$el=f.create(),f.createdSelf=!0),c.length>0&&f.$el.appendTo(c);var h,i=a.Deferred(),j=i.promise();f.$el.length>0&&(h=f.$el.data(b.dataTemplate))instanceof b.Template?j=j.then(function(){return h.destroy().then(function(){f.$el.data(b.dataTemplate,f)})}):f.$el.data(b.dataTemplate,f),j.then(function(){return f.destroying?e.rejectWith("destroy in progress"):(d.empty(f.opt.on)||f.$el.on(f.opt.on),f.raise("pre-init").isDefaultPrevented()?e.rejectWith("pre-init default prevented"):void 0)}).then(function(){return f.destroying?e.rejectWith("destroy in progress"):f.opt.delay<=0?e.resolved:a.Deferred(function(a){f._delay=setTimeout(function(){f._delay=null,a.resolve()},f.opt.delay)}).promise()}).then(function(){return f.destroying?e.rejectWith("destroy in progress"):f.raise("init").isDefaultPrevented()?e.rejectWith("init default prevented"):f.items.fetch()}).then(function(){if(f.destroying)return e.rejectWith("destroy in progress");if(f.raise("post-init").isDefaultPrevented())return e.rejectWith("post-init default prevented");var b=f.state.parse();f.state.set(d.empty(b)?f.state.initial():b),a(window).on("scroll.foogallery",{self:f},f.onWindowScroll).on("popstate.foogallery",{self:f},f.onWindowPopState)}).then(function(){return f.destroying?e.rejectWith("destroy in progress"):(f.raise("first-load"),f.loadAvailable())}).then(function(){if(f.destroying)return e.rejectWith("destroy in progress");f.initializing=!1,f.initialized=!0,f._check(200),f._check(500),f._check(1e3),f._check(2e3),f._check(5e3),f.raise("ready"),g.resolve(f)}).fail(function(a){g.reject(a)}),i.resolve()}).promise().fail(function(a){console.log("initialize failed",f,a),f.destroy()}))},create:function(){var b=this;return a("<div/>",{id:b.id,class:b.cls.container}).addClass(b.opt.classes)},destroy:function(){var b=this;return b.destroyed?e.resolved:(b.destroying=!0,a.Deferred(function(a){b.initializing&&d.promise(b._initialize)?b._initialize.always(function(){b.destroying=!1,b._destroy(),a.resolve()}):(b.destroying=!1,b._destroy(),a.resolve())}).promise())},_destroy:function(){var c=this;c.destroyed||(c.raise("destroy"),a(window).off("popstate.foogallery",c.onWindowPopState).off("scroll.foogallery",c.onWindowScroll),c.state.destroy(),c.pages&&c.pages.destroy(),c.items.destroy(),d.empty(c.opt.on)||c.$el.off(c.opt.on),c.raise("destroyed"),c.$el.removeData(b.dataTemplate),c.createdSelf&&c.$el.remove(),c.$el=c.state=c.items=c.pages=null,c.destroyed=!0,c.initializing=!1,c.initialized=!1)},loadAvailable:function(){var a,b=this;return a=b.pages?b.pages.available():b.items.available(),b.items.load(a)},_check:function(a){a=d.number(a)?a:0;var b=this;setTimeout(function(){!b.initialized||b.destroying&&b.destroyed||b.loadAvailable()},a)},raise:function(c,e){if(!d.string(c)||d.empty(c))return null;e=d.array(e)?e:[];var g=this,h=c.split(".")[0],i=f.camel("on-"+h),j=a.Event(h+".foogallery");return e.unshift(g),g.$el.trigger(j,e),b.debug.logf("{id}|{name}:",{id:g.id,name:h},e),d.fn(g[i])&&(e.unshift(j),g[i].apply(g.$el.get(0),e)),j},layout:function(){var a=this;null!==a._initialize&&a.raise("layout")},onWindowPopState:function(a){var b=a.data.self,c=a.originalEvent.state;d.empty(c)||c.id!==b.id||(b.state.set(c),b.loadAvailable())},onWindowScroll:function(a){var b=a.data.self;b._throttle.limit(function(){b.loadAvailable()})}}),b.template.register("core",b.Template,{id:null,type:"core",classes:"",on:{},lazy:!0,viewport:200,items:[],delay:100,throttle:50,timeout:6e4,srcset:"data-srcset",src:"data-src",template:{}},{container:"foogallery"},{},-100)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.str),function(a,b){a.Component=b.Class.extend({construct:function(a){this.tmpl=a},destroy:function(){this.tmpl=null}}),a.components=new b.Factory}(FooGallery,FooGallery.utils),function(a,b,c,d){b.State=b.Component.extend({construct:function(a){var b=this;b._super(a),b.apiEnabled=!!window.history&&!!history.replaceState,b.opt=b.tmpl.opt.state,b.enabled=b.opt.enabled,b.pushOrReplace=b.isPushOrReplace(b.opt.pushOrReplace)?b.opt.pushOrReplace:"replace";var c=d.escapeRegExp(b.tmpl.id),e=d.escapeRegExp(b.opt.values),f=d.escapeRegExp(b.opt.pair);b.regex={exists:new RegExp("^#"+c+"\\"+e+".+?"),values:new RegExp("(\\w+)"+f+"([^"+e+"]+)","g")}},destroy:function(){var a=this;a.clear(),a.opt=a.regex={},a._super()},isPushOrReplace:function(b){return-1!==a.inArray(b,["push","replace"])},exists:function(){return this.regex.exists.test(location.hash)&&this.regex.values.test(location.hash)},parse:function(){var b=this,d={};if(b.exists())if(b.enabled){d.id=b.tmpl.id;var e=location.hash.match(b.regex.values);a.each(e,function(e,f){var g=f.split(b.opt.pair);2===g.length&&(d[g[0]]=-1===g[1].indexOf(b.opt.array)?decodeURIComponent(g[1]):a.map(g[1].split(b.opt.array),function(a){return decodeURIComponent(a)}),c.string(d[g[0]])&&!isNaN(d[g[0]])&&(d[g[0]]=parseInt(d[g[0]])))})}else b.apiEnabled?history.replaceState(null,"",location.pathname+location.search):location.hash="#";return d},hashify:function(b){var d=this;if(c.hash(b)){var e=[];return a.each(b,function(b,f){c.empty(f)||"id"===b||(f=c.array(f)?a.map(f,function(a){return encodeURIComponent(a)}).join("+"):encodeURIComponent(f),e.push(b+d.opt.pair+f))}),e.length>0&&e.unshift("#"+d.tmpl.id),e.join(d.opt.values)}return""},replace:function(a){var b=this;if(b.enabled&&b.apiEnabled){a.id=b.tmpl.id;var d=b.hashify(a),e=c.empty(d);history.replaceState(e?null:a,"",e?location.pathname+location.search:d)}},push:function(a){var b=this;if(b.enabled&&b.apiEnabled){a.id=b.tmpl.id;var d=b.hashify(a),e=c.empty(d);history.pushState(e?null:a,"",e?location.pathname+location.search:d)}},update:function(a,b){var c=this;c.enabled&&c.apiEnabled&&(b=c.isPushOrReplace(b)?b:c.pushOrReplace,c[b](a))},clear:function(){this.exists()&&this.replace({})},initial:function(){var a=this,b=a.tmpl,c={};return b.pages&&b.pages.current>1&&(c.p=b.pages.current),c},get:function(a){var c=this,d=c.tmpl,e={};return a instanceof b.Item&&(e.i=a.id),d.pages&&d.pages.isValid(d.pages.current)&&(e.p=d.pages.current),e},set:function(a){var b=this,d=b.tmpl;if(c.hash(a)){d.items.reset();var e=d.items.get(a.i);if(d.pages){d.pages.rebuild();var f=d.pages.number(a.p);e&&!d.pages.contains(f,e)&&(f=d.pages.find(e),f=0!==f?f:1),d.pages.set(f,!c.empty(a),!1),e&&d.pages.contains(f,e)&&e.scrollTo()}else d.items.detach(d.items.all()),d.items.create(d.items.available(),!0),e&&e.scrollTo();c.empty(a.i)||(a.i=null,b.replace(a))}}}),b.template.configure("core",{state:{enabled:!1,pushOrReplace:"replace",values:"/",pair:":",array:"+"}}),b.components.register("state",b.State)}(FooGallery.$,FooGallery,FooGallery.utils.is,FooGallery.utils.str),function(a,b,c,d,e,f){b.Item=b.Component.extend({construct:function(a,b){var c=this;c._super(a),c.cls=a.cls.item,c.il8n=a.il8n.item,c.sel=a.sel.item,c.isAttached=!1,c.isCreated=!1,c.isLoading=!1,c.isLoaded=!1,c.isError=!1,c.isParsed=!1,c.$el=null,c.$inner=null,c.$anchor=null,c.$image=null,c.$caption=null,b=f.extend({},a.opt.item,b),c.id=b.id,c.href=b.href,c.src=b.src,c.srcset=b.srcset,c.width=b.width,c.height=b.height,c.title=b.title,c.alt=b.alt,c.caption=d.empty(b.caption)?c.title:b.caption,c.description=d.empty(b.description)?c.alt:b.description,c.attr=b.attr,c.tags=b.tags,c.maxWidth=b.maxWidth,c.maxCaptionLength=b.maxCaptionLength,c.maxDescriptionLength=b.maxDescriptionLength,c.showCaptionTitle=b.showCaptionTitle,c.showCaptionDescription=b.showCaptionDescription,c._thumbUrl=null,c._load=null},destroy:function(){var a=this;return a.tmpl.raise("destroy-item").isDefaultPrevented()||(a.isParsed&&!a.isAttached?a.append():!a.isParsed&&a.isAttached&&a.detach(),a._super()),null===a.tmpl},parse:function(c){var e=this,f=e.tmpl.opt,g=e.cls,h=e.sel,i=a(c);return!e.tmpl.raise("parse-item",[e,i]).isDefaultPrevented()&&(e.isCreated=i.is(h.elem))&&(e.$el=i.data(b.dataItem,e),e.$inner=e.$el.find(h.inner),e.$anchor=e.$el.find(h.anchor).on("click.foogallery",{self:e},e.onAnchorClick),e.$image=e.$anchor.find(h.image),e.$caption=e.$el.find(h.caption.elem).on("click.foogallery",{self:e},e.onCaptionClick),e.isAttached=e.$el.parent().length>0,e.isLoading=e.$el.is(h.loading),e.isLoaded=e.$el.is(h.loaded),e.isError=e.$el.is(h.error),e.id=e.$anchor.data("id"),e.tags=e.$anchor.data("tags"),e.href=e.$anchor.attr("href"),e.src=e.$image.attr(f.src),e.srcset=e.$image.attr(f.srcset),e.width=parseInt(e.$image.attr("width")),e.height=parseInt(e.$image.attr("height")),e.title=e.$image.attr("title"),e.alt=e.$image.attr("alt"),e.caption=e.$anchor.data("title")||e.$anchor.data("captionTitle"),e.description=e.$anchor.data("description")||e.$anchor.data("captionDesc"),d.empty(e.caption)&&(e.caption=e.title),d.empty(e.description)&&(e.description=e.alt),d.number(e.maxCaptionLength)&&e.maxCaptionLength>0&&!d.empty(e.caption)&&d.string(e.caption)&&e.caption.length>e.maxCaptionLength&&e.$caption.find(h.caption.title).html(e.caption.substr(0,e.maxCaptionLength)+"&hellip;"),d.number(e.maxDescriptionLength)&&e.maxDescriptionLength>0&&!d.empty(e.description)&&d.string(e.description)&&e.description.length>e.maxDescriptionLength&&e.$caption.find(h.caption.description).html(e.description.substr(0,e.maxDescriptionLength)+"&hellip;"),0===e.$el.find(h.loader).length&&e.$el.append(a("<div/>",{class:g.loader})),d.empty(e.$image.prop("src"))&&e.$image.prop("src",e.tmpl.items.placeholder(e.width,e.height)),!e.isCreated||!e.isAttached||e.isLoading||e.isLoaded||e.isError||e.$el.addClass(g.idle),e.fix(),e.isParsed=!0),e.isParsed&&e.tmpl.raise("parsed-item",[e]),e.isParsed},create:function(){var c=this;if(!c.isCreated&&d.string(c.href)&&d.string(c.src)&&d.number(c.width)&&d.number(c.height)){if(!c.tmpl.raise("create-item",[c]).isDefaultPrevented()){var e=c.tmpl.opt,f=c.cls,g=c.attr;g.elem.class=f.elem+" "+f.idle,g.inner.class=f.inner,g.anchor.class=f.anchor,g.anchor.href=c.href,g.anchor["data-id"]=c.id,g.anchor["data-title"]=c.caption,g.anchor["data-description"]=c.description,d.empty(c.tags)||(g.anchor["data-tags"]=JSON.stringify(c.tags)),g.image.class=f.image,g.image.src=c.tmpl.items.placeholder(c.width,c.height),g.image[e.src]=c.src,g.image[e.srcset]=c.srcset,g.image.width=c.width,g.image.height=c.height,g.image.title=c.title,g.image.alt=c.alt,c.$el=a("<div/>").attr(g.elem).data(b.dataItem,c),
c.$inner=a("<figure/>").attr(g.inner).appendTo(c.$el),c.$anchor=a("<a/>").attr(g.anchor).appendTo(c.$inner).on("click.foogallery",{self:c},c.onAnchorClick),c.$image=a("<img/>").attr(g.image).appendTo(c.$anchor),f=c.cls.caption,g=c.attr.caption,g.elem.class=f.elem,c.$caption=a("<figcaption/>").attr(g.elem).on("click.foogallery",{self:c},c.onCaptionClick);var h=!d.empty(c.caption),i=!d.empty(c.description);if(h||i){g.inner.class=f.inner,g.title.class=f.title,g.description.class=f.description;var j=a("<div/>").attr(g.inner).appendTo(c.$caption);if(h){var k;k=d.number(c.maxCaptionLength)&&c.maxCaptionLength>0&&d.string(c.caption)&&c.caption.length>c.maxCaptionLength?a("<div/>").attr(g.title).html(c.caption.substr(0,c.maxCaptionLength)+"&hellip;"):a("<div/>").attr(g.title).html(c.caption),j.append(k)}if(i){var l;l=d.number(c.maxDescriptionLength)&&c.maxDescriptionLength>0&&d.string(c.description)&&c.description.length>c.maxDescriptionLength?a("<div/>").attr(g.description).html(c.description.substr(0,c.maxDescriptionLength)+"&hellip;"):a("<div/>").attr(g.description).html(c.description),j.append(l)}}c.$caption.appendTo(c.$inner),0===c.$el.find(c.sel.loader).length&&c.$el.append(a("<div/>",{class:c.cls.loader})),c.isCreated=!0}c.isCreated&&c.tmpl.raise("created-item",[c])}return c.isCreated},append:function(){var a=this;if(a.isCreated&&!a.isAttached){a.tmpl.raise("append-item",[a]).isDefaultPrevented()||(a.tmpl.$el.append(a.$el),a.fix(),a.isAttached=!0),a.isAttached&&a.tmpl.raise("appended-item",[a])}return a.isAttached},detach:function(){var a=this;if(a.isCreated&&a.isAttached){a.tmpl.raise("detach-item",[a]).isDefaultPrevented()||(a.$el.detach(),a.unfix(),a.isAttached=!1),a.isAttached||a.tmpl.raise("detached-item",[a])}return!a.isAttached},load:function(){var b=this;if(d.promise(b._load))return b._load;if(!b.isCreated||!b.isAttached)return e.rejectWith("not created or attached");if(b.tmpl.raise("load-item",[b]).isDefaultPrevented())return e.rejectWith("default prevented");var c=b.cls,f=b.$image.get(0),g=f.src;return b.isLoading=!0,b.$el.removeClass(c.idle).removeClass(c.loaded).removeClass(c.error).addClass(c.loading),b._load=a.Deferred(function(a){d.undef(window.InstallTrigger)||(f.src=""),f.onload=function(){f.onload=f.onerror=null,b.isLoading=!1,b.isLoaded=!0,b.$el.removeClass(c.loading).addClass(c.loaded),b.unfix(),b.tmpl.raise("loaded-item",[b]),a.resolve(b)},f.onerror=function(){f.onload=f.onerror=null,b.isLoading=!1,b.isError=!0,b.$el.removeClass(c.loading).addClass(c.error),d.string(g)&&b.$image.prop("src",g),b.tmpl.raise("error-item",[b]),a.reject(b)},f.src=b.getThumbUrl()}).promise()},fix:function(){var a=this;if(a.isCreated&&!a.isLoading&&!a.isLoaded&&!a.isError){var b=a.width,c=a.height;if(!isNaN(b)&&!isNaN(c)){var e=d.fn(a.maxWidth)?a.maxWidth(a):a.$image.width();e<=0&&(e=b);var f=e/b,g=c*f;a.$image.css({width:e,height:g})}}return a},unfix:function(){var a=this;return a.isCreated&&a.$image.css({width:"",height:""}),a},getThumbUrl:function(a){a=!!d.boolean(a)&&a;var c=this;return!a&&d.string(c._thumbUrl)?c._thumbUrl:c._thumbUrl=b.parseSrc(c.src,c.width,c.height,c.srcset,c.$anchor.innerWidth(),c.$anchor.innerHeight())},scrollTo:function(a){var b=this;if(b.isAttached){var d=b.bounds(),e=c.getViewportBounds();switch(a){case"top":d.left+=d.width/2-e.width/2,d.top-=e.height/5;break;default:d.left+=d.width/2-e.width/2,d.top+=d.height/2-e.height/2}window.scrollTo(d.left,d.top)}return b},bounds:function(){return this.isAttached?c.getElementBounds(this.$el):null},intersects:function(a){return!!this.isAttached&&this.bounds().intersects(a)},onAnchorClick:function(a){var b=a.data.self,c=b.tmpl.state.get(b);b.tmpl.state.update(c)},onCaptionClick:function(b){var c=b.data.self;a(b.target).is(c.sel.caption.all)&&c.$anchor.length>0&&c.$anchor.get(0).click()}}),b.template.configure("core",{item:{id:"",href:"",src:"",srcset:"",width:0,height:0,title:"",alt:"",caption:"",description:"",tags:[],maxWidth:null,maxCaptionLength:0,maxDescriptionLength:0,showCaptionTitle:!0,showCaptionDescription:!0,attr:{elem:{},inner:{},anchor:{},image:{},caption:{elem:{},inner:{},title:{},description:{}}}}},{item:{elem:"fg-item",inner:"fg-item-inner",anchor:"fg-thumb",image:"fg-image",loader:"fg-loader",idle:"fg-idle",loading:"fg-loading",loaded:"fg-loaded",error:"fg-error",caption:{elem:"fg-caption",inner:"fg-caption-inner",title:"fg-caption-title",description:"fg-caption-desc"}}}),b.components.register("item",b.Item)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.obj),function(a,b,c,d,e){b.Items=b.Component.extend({construct:function(a){var b=this;b._super(a),b.idMap={},b._fetched=null,b._arr=[],b._available=[],b._canvas=document.createElement("canvas");var d=b.tmpl.cls.item.caption;b.tmpl.sel.item.caption.all=c.selectify([d.elem,d.inner,d.title,d.description])},destroy:function(){var b=this,c=b.all(),d=[];c.length>0&&(b.tmpl.raise("destroy-items",[c]),d=a.map(c,function(a){return a.destroy()?a:null}),d.length>0&&b.tmpl.raise("destroyed-items",[d])),b.idMap={},b._canvas=b._fetched=null,b._arr=[],b._available=[],b._super()},fetch:function(b){var c=this;if(!b&&d.promise(c._fetched))return c._fetched;var e=c.tmpl,f=e.sel,g=e.opt.items,h=a.Deferred(),i=c.make(e.$el.find(f.item.elem));return d.empty(g)?(i.push.apply(i,c.make(window[e.id+"-items"])),h.resolve(i)):d.array(g)?(i.push.apply(i,c.make(g)),h.resolve(i)):d.string(g)?a.get(g).then(function(a){i.push.apply(i,c.make(a)),h.resolve(i)},function(a,b,c){console.log("FooGallery: GET items error.",g,a,b,c),h.resolve(i)}):h.resolve(i),h.then(function(a){c._arr=a,c.idMap=c.createIdMap(a),c.setAvailable(c.all())}),c._fetched=h.promise()},all:function(){return this._arr.slice()},available:function(){return this._available.slice()},get:function(a){return!d.empty(a)&&this.idMap[a]?this.idMap[a]:null},setAvailable:function(a){this._available=d.array(a)?a:[]},reset:function(){this.setAvailable(this.all())},placeholder:function(a,c){return this._canvas&&this._canvas.toDataURL&&d.number(a)&&d.number(c)?(this._canvas.width=a,this._canvas.height=c,this._canvas.toDataURL()):b.emptyImage},loadable:function(b){var e,f=this,g=f.tmpl.opt;return g.lazy&&(e=c.getViewportBounds(g.viewport)),d.array(b)?a.map(b,function(a){return a.isCreated&&a.isAttached&&!a.isLoading&&!a.isLoaded&&!a.isError&&(!g.lazy||g.lazy&&a.intersects(e))?a:null}):[]},creatable:function(c){return d.array(c)?a.map(c,function(a){return a instanceof b.Item&&!a.isCreated?a:null}):[]},appendable:function(c){return d.array(c)?a.map(c,function(a){return a instanceof b.Item&&a.isCreated&&!a.isAttached?a:null}):[]},detachable:function(c){return d.array(c)?a.map(c,function(a){return a instanceof b.Item&&a.isCreated&&a.isAttached?a:null}):[]},jquerify:function(b){return a(a.map(b,function(a){return a.$el.get()}))},make:function(c){var e=this,f=[];if(d.jq(c)||d.array(c)){var g=[],h=a.makeArray(c);if(0===h.length)return f;e.tmpl.raise("make-items",[h]).isDefaultPrevented()||(f=a.map(h,function(a){var c=b.components.make("item",e.tmpl,d.hash(a)?a:{});return d.element(a)?c.parse(a)?(g.push(c),c):null:c})),f.length>0&&e.tmpl.raise("made-items",[f]),g.length>0&&e.tmpl.raise("parsed-items",[g])}return f},create:function(b,c){var e=this,f=[],g=e.creatable(b);if(g.length>0){e.tmpl.raise("create-items",[g]).isDefaultPrevented()||(f=a.map(g,function(a){return a.create()?a:null})),f.length>0&&e.tmpl.raise("created-items",[f])}return d.boolean(c)&&c?e.append(b):f},append:function(b){var c=this,d=[],e=c.appendable(b);if(e.length>0){c.tmpl.raise("append-items",[e]).isDefaultPrevented()||(d=a.map(e,function(a){return a.append()?a:null})),d.length>0&&c.tmpl.raise("appended-items",[d])}return d},detach:function(b){var c=this,d=[],e=c.detachable(b);if(e.length>0){c.tmpl.raise("detach-items",[e]).isDefaultPrevented()||(d=a.map(e,function(a){return a.detach()?a:null})),d.length>0&&c.tmpl.raise("detached-items",[d])}return d},load:function(b){var c=this;if(b=c.loadable(b),b.length>0){if(!c.tmpl.raise("load-items",[b]).isDefaultPrevented()){var d=a.map(b,function(a){return a.load()});return e.when(d).done(function(a){c.tmpl.raise("loaded-items",[a])})}}return e.resolveWith([])},createIdMap:function(b){var c={};return a.each(b,function(a,b){d.empty(b.id)&&(b.id=""+(a+1)),c[b.id]=b}),c}}),b.components.register("items",b.Items)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.str),function(a,b,c,d){b.Paging=b.Component.extend({construct:function(a){var b=this;b._super(a),b.opt=b.tmpl.opt.paging,b.cls=b.tmpl.cls.paging,b.il8n=b.tmpl.il8n.paging,b.sel=b.tmpl.sel.paging,b.pushOrReplace=b.opt.pushOrReplace,b.type=b.opt.type,b.theme=b.opt.theme,b.size=b.opt.size,b.position=b.opt.position,b.scrollToTop=b.opt.scrollToTop,b.current=0,b.total=0,b.ctrls=[],b._arr=[]},destroy:function(){var b=this;b._arr.splice(0,b._arr.length),a.each(b.ctrls.splice(0,b.ctrls.length),function(a,b){b.destroy()}),b._super()},build:function(){var a=this,c=a.tmpl.items.available();if(a.total=a.size>0&&c.length>0?Math.ceil(c.length/a.size):1,a.total<=1)a._arr.push(c),a.tmpl.items.detach(a._arr[0]);else for(var d=0;d<a.total;d++)a._arr.push(c.splice(0,a.size)),a.tmpl.items.detach(a._arr[d]);if(a.total>1&&b.paging.hasCtrl(a.type)){var e,f,g=a.position;"both"!==g&&"top"!==g||(e=b.paging.makeCtrl(a.type,a.tmpl,a,"top"),e.create()&&(e.append(),a.ctrls.push(e))),"both"!==g&&"bottom"!==g||(f=b.paging.makeCtrl(a.type,a.tmpl,a,"bottom"),f.create()&&(f.append(),a.ctrls.push(f)))}},rebuild:function(){var b=this;b.current=0,b.total=0,b._arr.splice(0,b._arr.length),a.each(b.ctrls.splice(0,b.ctrls.length),function(a,b){b.destroy()}),b.build()},all:function(){return this._arr.slice()},available:function(){return this.get(this.current)},controls:function(b){var c=this;c.isValid(b)&&a.each(c.ctrls,function(a,c){c.update(b)})},isValid:function(a){return d.number(a)&&a>0&&a<=this.total},number:function(a){return this.isValid(a)?a:0===this.current?1:this.current},create:function(a){var b=this;a=b.number(a);var c=a-1;b.tmpl.items.create(b._arr[c],!0);for(var d=0,e=b._arr.length;d<e;d++)d!==c&&b.tmpl.items.detach(b._arr[d]);b.current=a},get:function(a){var b=this;return b.isValid(a)?(a=b.number(a),b._arr[a-1]):[]},set:function(a,b,c){var e=this;if(e.isValid(a)){e.controls(a);var f,g=e.number(a);if(g!==e.current){var h=e.current,i=function(){if(c=!d.boolean(c)||c,c&&1===e.current&&!e.tmpl.state.exists()&&(f=e.tmpl.state.get(),e.tmpl.state.update(f,e.pushOrReplace)),e.create(g),c&&(f=e.tmpl.state.get(),e.tmpl.state.update(f,e.pushOrReplace)),e.scrollToTop&&d.boolean(b)&&b){var a=e.get(e.current);a.length>0&&a[0].scrollTo("top")}e.tmpl.raise("after-page-change",[e.current,h])};return!e.tmpl.raise("before-page-change",[e.current,g,i]).isDefaultPrevented()&&(i(),!0)}}return!1},find:function(b){for(var c=this,d=0,e=c._arr.length;d<e;d++)if(-1!==a.inArray(b,c._arr[d]))return d+1;return 0},contains:function(b,c){var d=this.get(b);return-1!==a.inArray(c,d)},first:function(){this.goto(1)},last:function(){this.goto(this._arr.length)},prev:function(){this.goto(this.current-1)},next:function(){this.goto(this.current+1)},goto:function(a){var b=this;b.set(a,!0)&&b.tmpl.loadAvailable()}}),b.PagingControl=b.Component.extend({construct:function(a,b,c){var d=this;d._super(a),d.pages=b,d.position=c,d.$container=null},create:function(){var b=this;return b.$container=a("<nav/>",{class:b.pages.cls.container}).addClass(b.pages.theme),!0},destroy:function(){var a=this;a.$container.remove(),a.$container=null},append:function(){var a=this;"top"===a.position?a.$container.insertBefore(a.tmpl.$el):a.$container.insertAfter(a.tmpl.$el)},update:function(a){}}),b.paging.register("default",b.Paging,null,{type:"none",theme:"fg-light",size:30,pushOrReplace:"push",position:"none",scrollToTop:!0},{container:"fg-paging-container"},null,-100)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b.Infinite=b.Paging.extend({construct:function(a){var b=this;b._super(a),b.distance=b.opt.distance,b._created=[]},build:function(a){this._super(a),this._created=[]},available:function(){var a,b,e=this,f=[],g=e.get(e.current),h=c.getViewportBounds();if(!d.empty(g)&&e._created.length!==e.total&&(a=g[g.length-1].bounds(),a.top-h.bottom<e.distance))return e.set(e.current+1,!1),e.available();for(var i,j=0,k=e._created.length;j<k;j++)i=j+1,g=e.get(i),b=g[0].bounds(),a=g[g.length-1].bounds(),(a.top-h.bottom<e.distance||b.bottom-h.top<e.distance)&&f.push.apply(f,g);return f},create:function(b){var c=this;b=c.number(b);for(var d=0;d<b;d++)-1===a.inArray(d,c._created)&&(c.tmpl.items.create(c._arr[d],!0),c._created.push(d));c.current=b}}),b.paging.register("infinite",b.Infinite,null,{type:"infinite",pushOrReplace:"replace",distance:200})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b.LoadMore=b.Infinite.extend({construct:function(a){this._super(a),this.amount=this.opt.amount,this._count=this.opt.amount},build:function(a){this._super(a),this._count=this.amount},available:function(){var b,e,f=this,g=[],h=f.get(f.current),i=c.getViewportBounds();if(!d.empty(h)&&f._created.length!==f.total&&(b=h[h.length-1].bounds(),b.top-i.bottom<f.distance)){var j=f.current+1;if(f.isValid(j)&&f._count<f.amount)return f._count++,f.set(j,!1),f.available()}f._created.length===f.total&&(d.empty(f.ctrls)||a.each(f.ctrls.splice(0,f.ctrls.length),function(a,b){b.destroy()}));for(var k,l=0,m=f._created.length;l<m;l++)k=l+1,h=f.get(k),e=h[0].bounds(),b=h[h.length-1].bounds(),(b.top-i.bottom<f.distance||e.bottom-i.top<f.distance)&&g.push.apply(g,h);return g},loadMore:function(){var a=this;a._count=0,a.tmpl.loadAvailable()}}),b.LoadMoreControl=b.PagingControl.extend({construct:function(b,c,d){this._super(b,c,d),this.$container=a(),this.$button=a()},create:function(){var b=this;return b.$container=a("<nav/>",{class:b.pages.cls.container}).addClass(b.pages.theme),b.$button=a("<button/>",{class:b.pages.cls.button,type:"button"}).html(b.pages.il8n.button).on("click.foogallery",{self:b},b.onButtonClick).appendTo(b.$container),!0},destroy:function(){var b=this;b.$button.off("click.foogallery",b.onButtonClick),b.$container.remove(),b.$container=a(),b.$button=a()},append:function(){var a=this;"top"===a.position?a.$container.insertBefore(a.tmpl.$el):a.$container.insertAfter(a.tmpl.$el)},onButtonClick:function(a){a.preventDefault(),a.data.self.pages.loadMore()}}),b.paging.register("loadMore",b.LoadMore,b.LoadMoreControl,{type:"loadMore",position:"bottom",pushOrReplace:"replace",amount:1,distance:200},{button:"fg-load-more"},{button:"Load More"})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b.Dots=b.Paging.extend({}),b.DotsControl=b.PagingControl.extend({construct:function(b,c,d){this._super(b,c,d),this.$container=a(),this.$list=a(),this.$items=a()},create:function(){for(var b,c=this,d=c.pages.cls,e=c.pages.il8n,f=[],g=a("<ul/>",{class:d.list}),h=0,i=c.pages.total;h<i;h++)f.push(b=c.createItem(h+1,e.page)),g.append(b);return c.$list=g,c.$container=a("<nav/>",{class:d.container}).addClass(c.pages.theme).append(g),c.$items=a(a.map(f,function(a){return a.get()})),!0},append:function(){var a=this;"top"===a.position?a.$container.insertBefore(a.tmpl.$el):a.$container.insertAfter(a.tmpl.$el)},destroy:function(){var b=this,c=b.pages.sel;b.$list.find(c.link).off("click.foogallery",b.onLinkClick),b.$container.remove(),b.$container=a(),b.$list=a(),b.$items=a()},update:function(a){this.setSelected(a-1)},setSelected:function(b){var c=this,e=c.pages.cls,f=c.pages.il8n,g=c.pages.sel;c.$items.filter(g.selected).removeClass(e.selected).each(function(b,c){var e=a(c),f=e.data("label"),h=e.find(g.reader);d.string(f)&&0!==h.length&&h.html(f)}),c.$items.eq(b).addClass(e.selected).each(function(b,c){var e=a(c),h=e.find(g.reader),i=h.html();d.string(i)&&0!==h.length&&(e.data("label",i),h.html(f.current))})},createItem:function(b,c,e,f,g){e=d.string(e)?e:b,c=d.string(c)?c:"";var h=this,i=h.pages.opt,j=h.pages.cls,k=a("<a/>",{class:j.link,href:"#page-"+b}).html(e).on("click.foogallery",{self:h,page:b},h.onLinkClick);d.empty(c)||k.attr("title",c.replace(/\{PAGE}/g,b).replace(/\{LIMIT}/g,i.limit+"")),g=d.string(g)?g:c,d.empty(g)||k.prepend(a("<span/>",{class:j.reader,text:g.replace(/\{PAGE}/g,"").replace(/\{LIMIT}/g,i.limit+"")}));var l=a("<li/>",{class:j.item}).append(k);return f=d.string(f)?f:"",d.empty(f)||l.addClass(f),l},onLinkClick:function(b){b.preventDefault();var c=b.data.self,d=b.data.page,e=c.pages.sel;a(this).closest(e.item).is(e.disabled)||(c.pages.set(d,!0),c.tmpl.loadAvailable())}}),b.paging.register("dots",b.Dots,b.DotsControl,{type:"dots",position:"both",pushOrReplace:"push"},{list:"fg-dots",item:"fg-dot-item",link:"fg-dot-link",disabled:"fg-disabled",selected:"fg-selected",visible:"fg-visible",reader:"fg-sr-only"},{current:"Current page",page:"Page {PAGE}"})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b.Pagination=b.Dots.extend({construct:function(a){this._super(a),this.limit=this.opt.limit,this.showFirstLast=this.opt.showFirstLast,this.showPrevNext=this.opt.showPrevNext,this.showPrevNextMore=0!==this.opt.limit&&this.opt.showPrevNextMore,this.pageKeywords=["first","prev","prevMore","nextMore","next","last"],this.sel.firstPrev=[this.sel.first,this.sel.prev].join(","),this.sel.nextLast=[this.sel.next,this.sel.last].join(","),this.range={index:-1,start:-1,end:-1,changed:!1,selected:!1}},build:function(a){this._super(a),this.range={index:-1,start:-1,end:-1,changed:!1,selected:!1}},controls:function(b){var c=this;c.isValid(b)&&(c.range=c.getControlRange(b),a.each(c.ctrls,function(a,b){b.update(c.range)}))},isValid:function(a){return this._super(a)||this.isKeyword(a)},isKeyword:function(b){return d.string(b)&&-1!==a.inArray(b,this.pageKeywords)},number:function(a){var b=this;return"first"===a&&(a=1),"prev"===a&&(a=b.current-1),"next"===a&&(a=b.current+1),"last"===a&&(a=b.total),"prevMore"!==a&&"nextMore"!==a||(a=b.current),b._super(a)},getControlRange:function(a){var b=this;switch(a){case"prevMore":return b._range(b.range.start-1,!1,!1);case"nextMore":return b._range(b.range.end+1,!0,!1);default:return a=b.number(a),b._range(a-1,a<=b.current)}},_range:function(a,b,c){var e=this,f={index:a,start:e.range.start,end:e.range.end,changed:!1,selected:!d.boolean(c)||c};if(e.total<=e.limit||0===e.limit)f.start=0,f.end=e.total-1;else if(a<f.start||a>f.end){var g=a+(e.limit-1),h=a-(e.limit-1);if(b)for(f.start=a,f.end=g;f.end>e.total;)f.start-=1,f.end-=1;else for(f.start=h,f.end=a;f.start<0;)f.start+=1,f.end+=1}return(f.changed=f.start!==e.range.start||f.end!==e.range.end)&&(e.range=f),f}}),b.PaginationControl=b.DotsControl.extend({construct:function(b,c,d){this._super(b,c,d),this.$buttons=a()},create:function(){var b=this;if(b._super()){var c,d=b.pages.total<=b.pages.limit||0===b.pages.limit,e=[];return!d&&b.pages.showPrevNextMore&&(e.push(c=b.createButton("prevMore")),b.$list.prepend(c)),b.pages.showPrevNext&&(e.push(c=b.createButton("prev")),b.$list.prepend(c)),b.pages.showFirstLast&&(e.push(c=b.createButton("first")),b.$list.prepend(c)),!d&&b.pages.showPrevNextMore&&(e.push(c=b.createButton("nextMore")),b.$list.append(c)),b.pages.showPrevNext&&(e.push(c=b.createButton("next")),b.$list.append(c)),b.pages.showFirstLast&&(e.push(c=b.createButton("last")),b.$list.append(c)),b.$buttons=a(a.map(e,function(a){return a.get()})),!0}return!1},destroy:function(){this._super(),this.$buttons=a()},update:function(a){var b=this,c=b.pages.sel;a.changed&&b.setVisible(a.start,a.end),a.selected&&(b.setSelected(a.index),b.toggleDisabled(b.$buttons.filter(c.firstPrev),a.index<=0),b.toggleDisabled(b.$buttons.filter(c.nextLast),a.index>=b.pages.total-1)),b.toggleDisabled(b.$buttons.filter(c.prevMore),a.start<=0),b.toggleDisabled(b.$buttons.filter(c.nextMore),a.end>=b.pages.total-1)},setVisible:function(a,b){var c=this,d=c.pages.cls;c.$items.removeClass(d.visible).slice(a,b+1).addClass(d.visible)},toggleDisabled:function(a,b){var c=this,d=c.pages.cls,e=c.pages.sel;b?a.addClass(d.disabled).find(e.link).attr("tabindex",-1):a.removeClass(d.disabled).find(e.link).removeAttr("tabindex")},createButton:function(a){var b=this,c=b.pages.cls,d=b.pages.il8n;return b.createItem(a,d.labels[a],d.buttons[a],c.button+" "+c[a])}}),b.paging.register("pagination",b.Pagination,b.PaginationControl,{type:"pagination",position:"both",pushOrReplace:"push",limit:5,showPrevNext:!0,showFirstLast:!0,showPrevNextMore:!0},{list:"fg-pages",item:"fg-page-item",button:"fg-page-button",link:"fg-page-link",first:"fg-page-first",prev:"fg-page-prev",prevMore:"fg-page-prev-more",nextMore:"fg-page-next-more",next:"fg-page-next",last:"fg-page-last",disabled:"fg-disabled",selected:"fg-selected",visible:"fg-visible",reader:"fg-sr-only"},{buttons:{first:"&laquo;",prev:"&lsaquo;",next:"&rsaquo;",last:"&raquo;",prevMore:"&hellip;",nextMore:"&hellip;"},labels:{current:"Current page",page:"Page {PAGE}",first:"First page",prev:"Previous page",next:"Next page",last:"Last page",prevMore:"Select from previous {LIMIT} pages",nextMore:"Select from next {LIMIT} pages"}})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c){b.DefaultTemplate=b.Template.extend({}),b.template.register("default",b.DefaultTemplate,null,{container:"foogallery fg-default"})}(FooGallery.$,FooGallery,FooGallery.utils),function(a,b,c,d){b.MasonryTemplate=b.Template.extend({construct:function(a,b){this._super(a,b),this.masonry=null,this.style=null,this.$columnWidth=null},createStylesheet:function(){var a=this;return a.style=document.createElement("style"),a.style.appendChild(document.createTextNode("")),document.head.appendChild(a.style),a.style.sheet},onPreInit:function(b,c){var e=c.sel,f=c.cls;f.layouts=a.map(f.layout,function(a){return a}).join(" "),d.string(f.layout[c.template.layout])||(c.template.layout="col4");var g="fixed"===c.template.layout;if(c.template.isFitWidth=g,c.template.percentPosition=!g,c.template.transitionDuration=0,c.template.itemSelector=e.item.elem,c.$el.removeClass(f.layouts).addClass(f.layout[c.template.layout]),g||(0===c.$el.find(e.gutterWidth).length&&c.$el.prepend(a("<div/>").addClass(f.gutterWidth)),c.template.gutter=e.gutterWidth),0===c.$el.find(e.columnWidth).length&&c.$el.prepend(a("<div/>").addClass(f.columnWidth)),d.number(c.template.columnWidth)&&c.$el.find(e.columnWidth).width(c.template.columnWidth),c.template.columnWidth=e.columnWidth,g&&d.number(c.template.gutter)){var h=c.createStylesheet(),i="#"+c.id+e.container+" "+e.item.elem+" { margin-bottom: "+c.template.gutter+"px; }";h.insertRule(i,0)}c.masonry=new Masonry(c.$el.get(0),c.template)},onInit:function(a,b){b.masonry.layout()},onPostInit:function(a,b){b.masonry.layout()},onReady:function(a,b){b.masonry.layout()},onDestroy:function(a,b){b.$el.find(b.sel.columnWidth).remove(),b.$el.find(b.sel.gutterWidth).remove(),b.masonry instanceof Masonry&&b.masonry.destroy(),b.style&&b.style.parentNode&&b.style.parentNode.removeChild(b.style)},onLayout:function(a,b){b.masonry.layout()},onParsedItems:function(a,b,c){b.masonry.layout()},onAppendedItems:function(a,b,c){c=b.items.jquerify(c),c=b.masonry.addItems(c),b.masonry.layoutItems(c,!0)},onDetachItem:function(a,b,c){a.isDefaultPrevented()||(a.preventDefault(),b.masonry.remove(c.$el),c.isAttached=!1,c.unfix())},onDetachedItems:function(a,b,c){b.masonry.layout()}}),b.template.register("masonry",b.MasonryTemplate,{template:{layout:"col4"}},{container:"foogallery fg-masonry",columnWidth:"fg-column-width",gutterWidth:"fg-gutter-width",layout:{fixed:"fg-masonry-fixed",col2:"fg-masonry-2col",col3:"fg-masonry-3col",col4:"fg-masonry-4col",col5:"fg-masonry-5col"}})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b.Justified=c.Class.extend({construct:function(c,d){this.$el=a(c),this.options=a.extend(!0,{},b.Justified.defaults,d),this._items=[]},init:function(){var b=this;d.string(b.options.maxRowHeight)&&(b.options.maxRowHeight.indexOf("%")?b.options.maxRowHeight=b.options.rowHeight*(parseInt(b.options.maxRowHeight)/100):b.options.maxRowHeight=parseInt(b.options.maxRowHeight)),b.layout(!0),a(window).on("resize.justified",{self:b},b.onWindowResize)},destroy:function(){a(window).off("resize.justified"),a.each(this._items,function(a,b){b.$item.removeAttr("style").removeClass("fg-positioned")}),this.$el.removeAttr("style")},parse:function(){var b=this;return b._items=b.$el.find(b.options.itemSelector).removeAttr("style").removeClass("fg-positioned").map(function(c,d){var e=a(d),f=e.outerWidth(),g=e.outerHeight();return{index:c,width:f*(b.options.rowHeight/g),height:b.options.rowHeight,top:0,left:0,$item:e}}).get()},round:function(a){return Math.round(a)},layout:function(a,b){a=!!d.boolean(a)&&a,b=!d.boolean(b)||b,(a||0===this._items.length)&&this.parse();for(var c,e=this,f=e.$el.width(),g=e.rows(f),h=0,i=0,j=g.length;i<j;i++)c=g[i],h=i===j-1?e.lastRow(c,f,h):e.justify(c,f,h),e.render(c);e.$el.height(h),b&&e.$el.width()<f&&e.layout(!1,!1)},render:function(a){for(var b,c=0,d=a.items.length;c<d;c++)b=a.items[c],a.visible?b.$item.css({width:b.width,height:b.height,top:b.top,left:b.left,display:"",maxHeight:this.options.maxRowHeight>0?this.options.maxRowHeight:""}).addClass("fg-positioned"):b.$item.css("display","none")},lastRow:function(a,b,c){var d=this;switch(d.options.lastRow){case"hide":a.visible=!1;break;case"justify":c=d.justify(a,b,c);break;case"nojustify":c=a.width/b>d.options.justifyThreshold?d.justify(a,b,c):d.position(a,b,c,"left");break;case"right":case"center":case"left":c=d.position(a,b,c,d.options.lastRow);break;default:c=d.position(a,b,c,"left")}return c},justify:function(a,b,c){var d=this,e=0,f=d.options.margins*(a.items.length-1),g=(b-f)/a.width;a.index>0&&(c+=d.options.margins),a.top=c,a.width=d.round(a.width*g),a.height=d.round(a.height*g);for(var h,i=0,j=a.items.length;i<j;i++)h=a.items[i],h.width=d.round(h.width*g),h.height=d.round(h.height*g),h.top=c,i>0&&(e+=d.options.margins),h.left=e,e+=h.width;return c+(a.height>d.options.maxRowHeight?d.options.maxRowHeight:a.height)},position:function(a,b,c,d){var e=this,f=a.items[a.items.length-1],g=b-(f.left+f.width);a.index>0&&(c+=e.options.margins),a.top=c;for(var h,i=0,j=a.items.length;i<j;i++)h=a.items[i],h.top=c,"center"===d?h.left+=g/2:"right"===d&&(h.left+=g);return c+a.height},items:function(){return a.map(this._items,function(a){return{index:a.index,width:a.width,height:a.height,$item:a.$item,top:a.top,left:a.left}})},rows:function(a){for(var b=this,c=b.items(),d=[],e=c.length>0,f=-1,g=0;e;){f+=1,f>0&&(g+=b.options.margins);for(var h,i,j,k={index:f,visible:!0,top:g,width:0,height:b.options.rowHeight,items:[]},l=[],m=0,n=0,o=c.length;n<o&&(i=c[n],!((h=k.width+i.width)>a&&n>0));n++)h>a&&0==n&&(h=a,j=a/i.width,i.width=b.round(i.width*j),i.height=b.round(i.height*j),k.height=i.height),i.top=k.top,n>0&&(m+=b.options.margins),i.left=m,m+=i.width,k.width=h,k.items.push(i),l.push(n);if(0===l.length){e=!1;break}l.sort(function(a,b){return b-a});for(var p=0,q=l.length;p<q;p++)c.splice(l[p],1);d.push(k),e=c.length>0}return d},onWindowResize:function(a){a.data.self.layout()}}),b.Justified.defaults={itemSelector:".fg-item",rowHeight:150,maxRowHeight:"200%",margins:0,lastRow:"center",justifyThreshold:.5}}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c){b.JustifiedTemplate=b.Template.extend({onPreInit:function(a,c){c.justified=new b.Justified(c.$el.get(0),c.template)},onInit:function(a,b){b.justified.init()},onPostInit:function(a,b){b.justified.layout()},onReady:function(a,b){b.justified.layout()},onDestroy:function(a,b){b.justified.destroy()},onLayout:function(a,b){b.justified.layout(!0)},onParsedItems:function(a,b,c){b.justified.layout()},onAppendedItems:function(a,b,c){b.justified.layout(!0)},onDetachedItems:function(a,b,c){b.justified.layout(!0)}}),b.template.register("justified",b.JustifiedTemplate,null,{container:"foogallery fg-justified"})}(FooGallery.$,FooGallery,FooGallery.utils),function(a,b,c,d){b.Portfolio=c.Class.extend({construct:function(c,d){this.$el=a(c),this.options=a.extend(!0,{},b.Portfolio.defaults,d),this._items=[]},init:function(){var b=this;a(window).on("resize.portfolio",{self:b},b.onWindowResize),b.layout(!0)},destroy:function(){a(window).off("resize.portfolio"),a.each(this._items,function(a,b){b.$item.removeAttr("style").removeClass("fg-positioned")}),this.$el.removeAttr("style")},parse:function(){var b=this;return b._items=b.$el.find(".fg-item").removeAttr("style").removeClass("fg-positioned").map(function(b,c){var d=a(c),e=d.find(".fg-thumb"),f=e.find(".fg-image");return d.find(".fg-caption").css("max-width",f.width()),{index:b,width:d.outerWidth(),height:d.outerHeight(),top:0,left:0,$item:d,$thumb:e}}).get()},round:function(a){return Math.round(2*a)/2},layout:function(a,b){a=!!d.boolean(a)&&a,b=!d.boolean(b)||b,(a||0===this._items.length)&&this.parse();for(var c,e=this,f=e.$el.width(),g=e.rows(f),h=0,i=0,j=g.length;i<j;i++)c=g[i],h=e.position(c,f,h,e.options.align),e.render(c);e.$el.height(h),b&&e.$el.width()<f&&e.layout(!1,!1)},render:function(a){for(var b,c=0,d=a.items.length;c<d;c++)b=a.items[c],a.visible?b.$item.css({width:b.width,height:a.height,top:b.top,left:b.left,display:""}).addClass("fg-positioned"):b.$item.css("display","none")},position:function(a,b,c,d){var e=this,f=a.items[a.items.length-1],g=b-(f.left+f.width);a.index>0&&(c+=e.options.gutter),a.top=c;for(var h,i=0,j=a.items.length;i<j;i++)h=a.items[i],h.top=c,"center"===d?h.left+=g/2:"right"===d&&(h.left+=g);return c+a.height},items:function(){return a.map(this._items,function(a){return{index:a.index,width:a.width,height:a.height,$item:a.$item,$thumb:a.$thumb,top:a.top,left:a.left}})},rows:function(a){for(var b=this,c=b.items(),d=[],e=c.length>0,f=-1,g=0;e;){f+=1,f>0&&(g+=b.options.gutter);for(var h,i,j,k={index:f,visible:!0,top:g,width:0,height:0,items:[]},l=[],m=0,n=0,o=c.length;n<o&&(i=c[n],!((h=k.width+i.width)>a&&n>0));n++)h>a&&0==n&&(h=a,j=a/i.width,i.width=b.round(i.width*j),i.height=b.round(i.height*j),k.height=i.height),i.top=k.top,n>0&&(m+=b.options.gutter),n!==o-1&&(h+=b.options.gutter),i.left=m,m+=i.width,i.height>k.height&&(k.height=i.height),k.width=h,k.items.push(i),l.push(n);if(0===l.length){e=!1;break}l.sort(function(a,b){return b-a});for(var p=0,q=l.length;p<q;p++)c.splice(l[p],1);d.push(k),e=c.length>0}return d},onWindowResize:function(a){a.data.self.layout()}}),b.Portfolio.defaults={gutter:40,align:"center"}}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c){b.PortfolioTemplate=b.Template.extend({construct:function(a,b){this._super(a,b),this.portfolio=null},onPreInit:function(a,c){c.portfolio=new b.Portfolio(c.$el.get(0),c.template)},onInit:function(a,b){b.portfolio.init()},onDestroy:function(a,b){b.portfolio.destroy()},onLayout:function(a,b){b.portfolio.layout(!0)},onParsedItems:function(a,b,c){b.portfolio.layout()},onAppendedItems:function(a,b,c){b.portfolio.layout(!0)},onDetachedItems:function(a,b,c){b.portfolio.layout(!0)}}),b.template.register("simple_portfolio",b.PortfolioTemplate,{gutter:40},{container:"foogallery fg-simple_portfolio"})}(FooGallery.$,FooGallery,FooGallery.utils),function(a,b,c,d){b.ImageViewerTemplate=b.Template.extend({construct:function(a,b){this._super(d.extend({},a,{paging:{pushOrReplace:"replace",theme:"fg-light",type:"default",size:1,position:"none",scrollToTop:!1}}),b),this.$inner=this.$el.find(".fiv-inner-container"),this.$current=this.$el.find(".fiv-count-current"),this.$total=this.$el.find(".fiv-count-total"),this.$prev=this.$el.find(".fiv-prev"),this.$next=this.$el.find(".fiv-next")},onInit:function(a,b){b.template.attachFooBox&&b.$el.on("foobox.previous",{self:b},b.onFooBoxPrev).on("foobox.next",{self:b},b.onFooBoxNext),b.$prev.on("click",{self:b},b.onPrevClick),b.$next.on("click",{self:b},b.onNextClick)},onFirstLoad:function(a,b){b.update()},
onDestroy:function(a,b){b.template.attachFooBox&&b.$el.off({"foobox.previous":b.onFooBoxPrev,"foobox.next":b.onFooBoxNext}),b.$prev.off("click",b.onPrevClick),b.$next.off("click",b.onNextClick)},onAppendItem:function(a,b,c){a.preventDefault(),b.$inner.append(c.$el),c.fix(),c.isAttached=!0},update:function(){this.pages&&(this.$current.text(this.pages.current),this.$total.text(this.pages.total))},prev:function(){this.pages&&(this.pages.prev(),this.update())},next:function(){this.pages&&(this.pages.next(),this.update())},onFooBoxPrev:function(a){a.data.self.prev()},onFooBoxNext:function(a){a.data.self.next()},onPrevClick:function(a){a.preventDefault(),a.stopPropagation(),a.data.self.prev()},onNextClick:function(a){a.preventDefault(),a.stopPropagation(),a.data.self.next()}}),b.template.register("image-viewer",b.ImageViewerTemplate,{template:{attachFooBox:!1}},{container:"foogallery fg-image-viewer"})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.obj),function(a,b,c){b.ThumbnailTemplate=b.Template.extend({construct:function(a,b){this._super(c.extend({},a,{paging:{type:"none"}}),b)}}),b.template.register("thumbnail",b.ThumbnailTemplate,null,{container:"foogallery fg-thumbnail"})}(FooGallery.$,FooGallery,FooGallery.utils.obj),function(a,b,c,d){function e(b,c){if(!(this instanceof e))return new e(b,c);this.$el=a(b).addClass("foogrid"),this.options=this._options(c,this.$el.data()),this.id=this.options.id||f--,this.deeplinking=new e.Deeplinking(this),this.parser=new e.Parser(this.options.parser),this.content=new e.Content(this),this.items=[],this.disableTransitions=!1}var f=-1;e.defaults={id:null,scroll:!0,scrollOffset:0,scrollSmooth:!0,loop:!0,index:null,external:"_blank",externalText:null,keyboard:!0,transitionRow:!0,transitionOpen:!0,deeplinking:!1,deeplinkingPrefix:"foogrid",video:{},parser:{}},e.prototype.init=function(){this.layout(!0)},e.prototype.layout=function(b,c){var d=this;b&&(a.each(d.items,function(a,b){b.destroy()}),d.items=a.map(a.makeArray(d.$el.find(".fg-item")),function(a,b){return new e.Item(d,a,b)})),d.content.layout(b,c)},e.prototype.destroy=function(){a.each(this.items,function(a,b){b.destroy()}),this.content.destroy(),this.parser.destroy(),this.deeplinking.destroy()},e.prototype._options=function(b,c){var f=a.extend(!0,{},e.defaults,b);return d.number(c.id)&&(f.id=c.id),d.boolean(c.loop)&&(f.loop=c.loop),d.boolean(c.scroll)&&(f.scroll=c.scroll),d.boolean(c.scrollSmooth)&&(f.scrollSmooth=c.scrollSmooth),d.boolean(c.scrollOffset)&&(f.scrollOffset=c.scrollOffset),d.string(c.external)&&(f.external=c.external),d.string(c.externalText)&&(f.externalText=c.externalText),d.boolean(c.keyboard)&&(f.keyboard=c.keyboard),d.boolean(c.transitionRow)&&(f.transitionRow=c.transitionRow),d.boolean(c.transitionOpen)&&(f.transitionOpen=c.transitionOpen),d.boolean(c.deeplinking)&&(f.deeplinking=c.deeplinking),d.string(c.deeplinkingPrefix)&&(f.deeplinkingPrefix=c.deeplinkingPrefix),f},e.prototype.redraw=function(){this.content.redraw()},e.prototype.captions=function(){return this.$el.hasClass("foogrid-caption-below")||this.$el.hasClass("foogrid-caption-right")},e.prototype.transitions=function(){return!this.disableTransitions&&(this.$el.hasClass("foogrid-transition-fade")||this.$el.hasClass("foogrid-transition-horizontal")||this.$el.hasClass("foogrid-transition-vertical"))},e.prototype.open=function(a){return this.content.open(a)},e.prototype.toggle=function(a){return this.content.toggle(a)},e.prototype.prev=function(){return this.content.prev()},e.prototype.next=function(){return this.content.next()},e.prototype.isActive=function(){return this.content.active instanceof e.Item},e.prototype.close=function(a){a=!!d.boolean(a)&&a;var b=this;return b.disableTransitions=a,b.content.close().then(function(){b.disableTransitions=!1})},b.FooGrid=e,a.fn.foogrid=function(b){return this.each(function(c,f){var g=a(this),h=g.data("__FooGrid__");d(h,e)&&h.destroy(),g.data("__FooGrid__",new e(f,b))})}}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b&&(b.Parser=function(a){if(!(this instanceof b.Parser))return new b.Parser(a);this._init(a)},b.Parser.defaults={url:["attr:href","data:url","data:image","data:video"],external:["data:external","attr:href","data:url","data:image","data:video"],type:{image:/\.(jpg|jpeg|png|gif|bmp)/i,video:/youtube(-nocookie)?\.com\/(watch|v|embed)|youtu\.be|vimeo\.com|\.mp4|\.ogv|\.wmv|\.webm|(.+)?(wistia\.(com|net)|wi\.st)\/.*|(www.)?dailymotion\.com|dai\.ly/i,iframe:/^(?!.*?(youtube(-nocookie)?\.com\/(watch|v|embed)|youtu\.be|vimeo\.com|\.mp4|\.ogv|\.wmv|\.webm|(.+)?(wistia\.(com|net)|wi\.st)\/.*|(www.)?dailymotion\.com|dai\.ly|\.(jpg|jpeg|png|gif|bmp)($|\?|#)))https?:\/\/.*?/i,html:/^#.+?$/i},thumbnail:["attr:src","data:thumbnail"],title:["attr:title","data:title","data:captionTitle"],description:["data:description","data:captionDesc","attr:alt"]},b.Parser.prototype._init=function(c){this.options=a.extend(!0,{},b.Parser.defaults,c),this._a=document.createElement("a")},b.Parser.prototype.destroy=function(){},b.Parser.prototype.parse=function(a){var b={url:this._url(a),external:this._external(a),type:this._type(a),title:this._title(a),description:this._description(a)};return"video"===b.type&&(b.thumbnail=this._thumbnail(a)),d.string(b.url)?b:null},b.Parser.prototype._full_url=function(a){return this._a.href=a,this._a.href},b.Parser.prototype._parse=function(b,c){var e,f=null,g=function(b,c){var e=c.split(":");return 2===e.length&&b instanceof a&&d.fn(b[e[0]])?b[e[0]](e[1]):null};return d.string(c)?f=g(b,c):d.array(c)&&a.each(c,function(a,c){if(!d.undef(e=g(b,c))&&null!==e)return f=e,!1}),f},b.Parser.prototype._url=function(a){var b=this._parse(a,this.options.url);return this._full_url(b)},b.Parser.prototype._external=function(a){var b=this._parse(a,this.options.external);return this._full_url(b)},b.Parser.prototype._type=function(b){var c;if(d.string(c=b.data("type"))&&c in this.options.type)return c;c=b.attr("href");var e=null;return a.each(this.options.type,function(a,b){if(b.test(c))return e=a,!1}),e},b.Parser.prototype._thumbnail=function(a){var b,c;return 0!==(b=a.find("img")).length&&(c=this._parse(b,this.options.thumbnail))?c:null},b.Parser.prototype._title=function(a){return this._parse(a,this.options.title)},b.Parser.prototype._description=function(a){var b;if(b=this._parse(a,this.options.description))return b;var c;return 0!==(c=a.find("img")).length&&(b=this._parse(c,this.options.description))?b:null})}(FooGallery.$,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d,e,f){c&&(c.Content=function(a){if(!(this instanceof c.Content))return new c.Content(a);this._init(a)},c.Content.prototype._init=function(b){this.grid=b,this.index=this.grid.options.index,this.active=null,this.$prev=null,this.$next=null,this.$close=null,this.$fullscreen=null,this.$external=null,this.$wrap=a("<div/>"),this.fullscreen=!1,this.busy=!1,this.first=!0,this.$li=this.$createContent()},c.Content.prototype.destroy=function(){this.$prev.off("click.gg",this.onPrevClick),this.$next.off("click.gg",this.onNextClick),this.$close.off("click.gg",this.onCloseClick),this.$fullscreen.off("click.gg",this.onFullscreenClick),this.$wrap.remove(),this.$li.remove(),this.index=this.grid.options.index,this.active=this.$prev=this.$next=this.$close=this.$fullscreen=this.$external=this.$wrap=null,this.fullscreen=!1,this.busy=!1},c.Content.prototype.layout=function(a,b){a&&(this.index=e.number(b)?b:0,this.active=null,this.fullscreen=!1,this.busy=!1,this.first=!0),this._loop()},c.Content.prototype.redraw=function(){this._loop()},c.Content.prototype.$createContent=function(){var b=a("<section/>",{class:"foogrid-content"});return b.append(this.$createNav()),this.grid.options.keyboard&&b.attr("tabindex",1).on("keydown",{self:this},this.onKeyDown),b},c.Content.prototype.$createNav=function(){return this.$prev=a("<span/>",{class:"foogrid-nav-prev"}).on("click.gg",{self:this},this.onPrevClick).append("<i/>"),this.$next=a("<span/>",{class:"foogrid-nav-next"}).on("click.gg",{self:this},this.onNextClick).append("<i/>"),this.$close=a("<span/>",{class:"foogrid-nav-close"}).on("click.gg",{self:this},this.onCloseClick),this.$fullscreen=a("<span/>",{class:"foogrid-nav-fullscreen"}).on("click.gg",{self:this},this.onFullscreenClick),this.$external=a("<a/>",{class:"foogrid-nav-external",target:this.grid.options.external}),e.string(this.grid.options.externalText)&&""!==this.grid.options.externalText&&this.$external.addClass("foogrid-external-text").html(this.grid.options.externalText),[this.$prev,this.$next,this.$close,this.$fullscreen,this.$external]},c.Content.prototype._index=function(a){a=a||0;var b=this.grid.items.length;this.index=a>-1&&a<b?a:b>0&&a<0?this.grid.options.loop?b-1:0:b>0&&a>=b?this.grid.options.loop?0:b-1:null},c.Content.prototype._loop=function(){0!=this.index||this.grid.options.loop?this.$prev.removeClass("foogrid-disabled"):this.$prev.addClass("foogrid-disabled"),this.index!=this.grid.items.length-1||this.grid.options.loop?this.$next.removeClass("foogrid-disabled"):this.$next.addClass("foogrid-disabled")},c.Content.prototype.scrollTo=function(b,c,d){var f,g=this;return b=(e.number(b)?b:0)-+g.grid.options.scrollOffset,c=!e.boolean(c)||c,d=e.number(d)?d:300,1===(f=a("#wpadminbar")).length&&(b-=f.height()),a.Deferred(function(e){g.grid.options.scroll&&c?g.grid.options.scrollSmooth&&!g.fullscreen?a("html, body").animate({scrollTop:b},d,function(){e.resolve()}):(a("html, body").scrollTop(b),e.resolve()):e.resolve()})},c.Content.prototype._open=function(b,d,e){var g=this;return a.Deferred(function(a){b instanceof c.Item?(b.hasCaption?g.$li.addClass("foogrid-has-caption"):g.$li.removeClass("foogrid-has-caption"),g.scrollTo(b.$li.offset().top,d||g.first).then(function(){!g.first&&!d||g.fullscreen||b.$li.after(g.$li),g.$external.attr("href",b.content.external),g.grid.transitions()&&!g.fullscreen&&(g.grid.options.transitionOpen&&g.first||g.grid.options.transitionRow&&d)?(g.first=!1,f.start(g.$li,"foogrid-visible",!0,350).then(function(){a.resolve()})):a.resolve()})):a.resolve()}).always(function(){return g._loop(),g.$li.addClass("foogrid-visible").focus(),g.active=b,g.busy=!1,b.open(e)})},c.Content.prototype.open=function(b){if(this.busy)return a.when();if(this.busy=!0,this._index(b),e.number(this.index)&&this.grid.items[this.index]instanceof c.Item){var d,f,g=this,h=this.active,i=this.grid.items[this.index],j=this.grid.items.length-1,k=!0,l=!1;if(h instanceof c.Item){if(d=i.bottom(),f=h.bottom(),l=d!=f,k=h.index<i.index,(0===i.index&&h.index===j||i.index===j&&0===h.index)&&(k=!k),g.$li.removeClass("foogrid-has-caption"),l&&!g.fullscreen)return g.busy=!1,g.close(k,l).then(function(){return g.busy=!0,g._open(i,l,k)});h.close(k)}return g._open(i,l,k)}return a.when()},c.Content.prototype.close=function(b,d){if(this.busy)return a.when();this.busy=!0;var e=this;return a.Deferred(function(a){e.active instanceof c.Item?e.active.close(b).then(function(){e.grid.transitions()&&!e.fullscreen&&(e.grid.options.transitionRow&&d||e.grid.options.transitionOpen&&!d)?f.start(e.$li,"foogrid-visible",!1,350).then(function(){a.resolve()}):a.resolve()}):a.resolve()}).always(function(){e.$li.removeClass("foogrid-visible foogrid-has-caption foogrid-fullscreen").detach(),e.$prev.add(e.$next).removeClass("foogrid-disabled"),e.fullscreen=!1,e.active=null,e.busy=!1,d||(e.first=!0)})},c.Content.prototype.toggle=function(b){return this.busy?a.when():(this._index(b),e.number(this.index)&&this.grid.items[this.index]instanceof c.Item?this.active===this.grid.items[this.index]?this.close():this.open(b):a.when())},c.Content.prototype.prev=function(){return e.number(this.index)?this.open(this.index-1):a.when()},c.Content.prototype.next=function(){return e.number(this.index)?this.open(this.index+1):a.when()},c.Content.prototype.toggleFullscreen=function(){this.$li.hasClass("foogrid-fullscreen")?(this.active.$li.after(this.$li.removeClass("foogrid-fullscreen")),this.$wrap.remove(),this.$li.focus(),this.fullscreen=!1):(this.$wrap.attr("class",this.grid.$el.attr("class")).append(this.$li.addClass("foogrid-fullscreen")).appendTo("body"),this.$li.focus(),this.fullscreen=!0);var a=this.grid.$el.get(0);a.style.display="none",a.offsetHeight,a.style.display=""},c.Content.prototype.onPrevClick=function(a){a.preventDefault();var b=a.data.self;b.$prev.hasClass("foogrid-disabled")||b.prev()},c.Content.prototype.onNextClick=function(a){a.preventDefault();var b=a.data.self;b.$next.hasClass("foogrid-disabled")||b.next()},c.Content.prototype.onCloseClick=function(a){a.preventDefault(),a.data.self.close()},c.Content.prototype.onFullscreenClick=function(a){a.preventDefault(),a.data.self.toggleFullscreen()},c.Content.prototype.onKeyDown=function(a){var b=a.data.self;switch(a.which){case 39:b.next();break;case 37:b.prev();break;case 27:b.fullscreen?b.toggleFullscreen():b.close();break;case 13:a.altKey&&b.toggleFullscreen()}})}(FooGallery.$,FooGallery,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.transition),function(a,b,c,d,e){b&&(b.Item=function(a,c,d){if(!(this instanceof b.Item))return new b.Item(a,c,d);this._init(a,c,d)},b.Item.prototype._init=function(b,c,d){this.grid=b,this.index=d,this.$li=a(c).append("<span/>"),this.$link=this.$li.find(".fg-thumb").first().on("click.gg",{self:this},this.onClick),this.visible=!1,this.content=this.grid.parser.parse(this.$link),this.hasCaption=!1,this.player=null,this.$content=this.$create()},b.Item.prototype.destroy=function(){this.player&&this.player.destroy(),this.player=null,this.$li.removeClass("foogrid-visible").children("span").remove(),this.$link.off("click.gg",this.onClick),this.$content.remove(),this.$content=null,this.visible=!1,this.index=null,this.content={}},b.Item.prototype.$create=function(){var c,d,e=a("<div/>",{class:"foogrid-content-inner"});switch(this.content.type){case"image":d=a("<img/>",{src:this.content.url,class:"foogrid-image"});break;case"html":d=a(this.content.url).contents();break;case"video":this.player=new b.Player(this.grid,this.content.url),d=this.player.$el;break;case"iframe":default:d=a("<iframe/>",{src:this.content.url,class:"foogrid-iframe",frameborder:"no",webkitallowfullscreen:!0,mozallowfullscreen:!0,allowfullscreen:!0})}return e.append(d),(c=this.$createCaption())&&(this.hasCaption=!0,e.addClass("foogrid-has-caption").append(c)),e},b.Item.prototype.$createCaption=function(){var b=d.string(this.content.title),c=d.string(this.content.description);if(b||c){var e=a("<div/>",{class:"foogrid-caption"}).append(a("<div/>",{class:"foogrid-caption-separator"}));return b&&e.append(a("<h4/>",{class:"foogrid-title"}).html(this.content.title)),c&&e.append(a("<p/>",{class:"foogrid-description"}).html(this.content.description)),e}return null},b.Item.prototype.open=function(b){var c=this;return a.Deferred(function(a){c.visible=!0,b?c.$content.addClass("foogrid-reverse"):c.$content.removeClass("foogrid-reverse"),c.grid.content.$li.append(c.$content),c.$li.addClass("foogrid-visible"),c.grid.transitions()?e.start(c.$content,"foogrid-visible",!0,1e3).then(function(){c.$content.removeClass("foogrid-reverse"),c.player&&c.player.options.autoplay&&c.player.play(),a.resolve()}):(c.$content.removeClass("foogrid-reverse").addClass("foogrid-visible"),c.player&&c.player.options.autoplay&&c.player.play(),a.resolve())})},b.Item.prototype.close=function(c){var d=this;return a.Deferred(function(a){d.visible=!1,d.player instanceof b.Player&&d.player.pause(),d.$li.removeClass("foogrid-visible"),c?d.$content.removeClass("foogrid-reverse"):d.$content.addClass("foogrid-reverse"),d.grid.transitions()?e.start(d.$content,"foogrid-visible",!1,350).then(function(){d.$content.removeClass("foogrid-reverse").detach(),a.resolve()}):(d.$content.removeClass("foogrid-visible foogrid-reverse").detach(),a.resolve())})},b.Item.prototype.bottom=function(){return this.$li.offset().top+this.$li.height()},b.Item.prototype.onClick=function(a){a.preventDefault();var b=a.data.self;b.grid.toggle(b.index)})}(FooGallery.$,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.transition),function(a,b,c,d){b.Video=function(a,c){if(!(this instanceof b.Video))return new b.Video(a,c);this._init(a,c)},b.Video.prototype._init=function(b,c){this.autoplay=!!c,this._parse(b),this._mimeType(b);var d=navigator.userAgent.toLowerCase(),e=d.indexOf("msie ")>-1||d.indexOf("trident/")>-1||d.indexOf("edge/")>-1,f=!document.addEventListener;this.direct=!!this.hasMimeType&&-1!==a.inArray(this.mimeType,["video/mp4","video/wmv","video/ogg","video/webm"]),this.supported=!!this.hasMimeType&&(!this.direct||-1!==a.inArray(this.mimeType,e?f?[]:["video/mp4","video/wmv"]:["video/mp4","video/ogg","video/webm"]))},b.Video.prototype._parse=function(a){var b=a.split("#");this.hash=2==b.length?"#"+b[1]:"",b=b[0].split("?"),this.url=b[0];var c=this.url.match(/.*\/(.*)$/);this.id=c&&c.length>=2?c[1]:null,this.protocol="https"==a.substring(0,5)?"https:":"http:",this.params=[];for(var d,e=(2==b.length?b[1]:"").split(/[&;]/g),f=0,g=e.length;f<g;f++)d=e[f].split("="),2==d.length&&this.params.push({key:decodeURIComponent(d[0]),value:decodeURIComponent(d[1])})},b.Video.prototype._mimeType=function(a){this.mimeTypes={"video/youtube":/(www.)?youtube|youtu\.be/i,"video/vimeo":/(player.)?vimeo\.com/i,"video/wistia":/(.+)?(wistia\.(com|net)|wi\.st)\/.*/i,"video/daily":/(www.)?dailymotion\.com|dai\.ly/i,"video/mp4":/\.mp4/i,"video/webm":/\.webm/i,"video/wmv":/\.wmv/i,"video/ogg":/\.ogv/i},this.mimeType=null;for(var b in this.mimeTypes)this.mimeTypes.hasOwnProperty(b)&&this.mimeTypes[b].test(a)&&(this.mimeType=b);if(this.hasMimeType=null!==this.mimeType,"video/youtube"==this.mimeType)this.id=/embed\//i.test(this.url)?this.url.split(/embed\//i)[1].split(/[?&]/)[0]:a.split(/v\/|v=|youtu\.be\//i)[1].split(/[?&]/)[0],this.url=this.protocol+"//www.youtube.com/embed/"+this.id,this.autoplay&&this.param("autoplay","1"),this.param("modestbranding","1"),this.param("rel","0"),this.param("wmode","transparent"),this.param("showinfo","0");else if("video/vimeo"==this.mimeType)this.id=this.url.substr(this.url.lastIndexOf("/")+1),this.url=this.protocol+"//player.vimeo.com/video/"+this.id,this.autoplay&&this.param("autoplay","1"),this.param("badge","0"),this.param("portrait","0");else if("video/wistia"==this.mimeType){this.id=/embed\//i.test(this.url)?this.url.split(/embed\/.*?\//i)[1].split(/[?&]/)[0]:this.url.split(/medias\//)[1].split(/[?&]/)[0];var c=/playlists\//i.test(this.url);this.url=this.protocol+"//fast.wistia.net/embed/"+(c?"playlists":"iframe")+"/"+this.id,this.autoplay&&(c?this.param("media_0_0[autoPlay]","1"):this.param("autoPlay","1")),this.param("theme","")}else"video/daily"==this.mimeType&&(this.id=/\/video\//i.test(this.url)?this.url.split(/\/video\//i)[1].split(/[?&]/)[0].split(/[_]/)[0]:a.split(/dai\.ly/i)[1].split(/[?&]/)[0],this.url=this.protocol+"//www.dailymotion.com/embed/video/"+this.id,this.autoplay&&this.param("autoplay","1"),this.param("wmode","opaque"),this.param("info","0"),this.param("logo","0"),this.param("related","0"))},b.Video.prototype.param=function(a,b){for(var c=void 0===b,d="string"==typeof b&&""===b,e=this.params.length;e-- >0;)if(this.params[e].key==a)return c?this.params[e].value:void(d?this.params.splice(e,1):this.params[e].value=b);c||d||this.params.push({key:a,value:b})},b.Video.prototype.toString=function(){for(var a=this.params.length>0?"?":"",b=0,c=this.params.length;b<c;b++)0!=b&&(a+="&"),a+=encodeURIComponent(this.params[b].key)+"="+encodeURIComponent(this.params[b].value);return this.url+a+this.hash}}(FooGallery.$,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d){b&&(b.Player=function(a,c){if(!(this instanceof b.Player))return new b.Player(a,c);this._init(a,c)},b.Player.defaults={width:1280,height:720,autoplay:!0},b.Player.prototype._init=function(c,d){this.grid=c,this.options=a.extend(!0,{},b.Player.defaults,this.grid.options),this.urls=this._parse(d),this.direct=this._direct(),this.$video=null,this.$el=this.$create(),this.$video instanceof a&&(this.video=this.$video[0])},b.Player.prototype._parse=function(c){if("string"==typeof c){c=c.split(",");for(var d=0,e=c.length;d<e;d++)c[d]=new b.Video(a.trim(c[d]),this.options.autoplay);return c}return[]},b.Player.prototype._direct=function(){if(!document.addEventListener)return!1;for(var a=0,b=this.urls.length;a<b;a++)if(this.urls[a].direct&&this.urls[a].supported)return!0;return!1},b.Player.prototype.$create=function(){var b=a("<div/>",{class:"foogrid-video"}).css({width:"100%",height:"100%",maxWidth:this.options.width,maxHeight:this.options.height});return this.direct?b.append(this.$video=this.$createVideo(this.urls)):this.urls.length>0&&!this.urls[0].direct?b.append(this.$video=this.$createEmbed(this.urls[0])):null},b.Player.prototype.play=function(){this.video&&this.video instanceof HTMLVideoElement&&(this.video.load(),this.video.play())},b.Player.prototype.pause=function(){this.video&&this.video instanceof HTMLVideoElement&&this.video.pause()},b.Player.prototype.$createVideo=function(b){function c(){for(var a=0,b=h.length;a<b;a++)h[0].removeEventListener("error",c,!1);g.removeEventListener("error",c,!1),g.removeEventListener("loadeddata",d,!1)}function d(){for(var a=0,b=h.length;a<b;a++)h[0].removeEventListener("error",c,!1);g.removeEventListener("loadeddata",d,!1),g.removeEventListener("error",c,!1)}for(var e,f=a("<video/>",{controls:!0,preload:!1}).css({width:"100%",height:"100%"}),g=f[0],h=[],i=0,j=b.length;i<j;i++)b[i].direct&&(e=a("<source/>",{type:b[i].mimeType,src:b[i].toString()}),e[0].addEventListener("error",c,!1),h.push(e[0]),f.append(e));return g.addEventListener("error",c,!1),g.addEventListener("loadeddata",d,!1),g.readyState<4?g.load():d(),f},b.Player.prototype.$createEmbed=function(b){return a("<iframe/>",{src:b,frameborder:"no",width:this.options.width,height:this.options.height,webkitallowfullscreen:!0,mozallowfullscreen:!0,allowfullscreen:!0}).css({width:"100%",height:"100%"})})}(FooGallery.$,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is),function(a,b,c,d,e){if(b){b.Deeplinking=function(a){if(!(this instanceof b.Deeplinking))return new b.Deeplinking(a);this._init(a)},b.Deeplinking.prototype._init=function(b){if(this.grid=b,this.grid.options.deeplinking&&window.history){a(window).on("popstate",{self:this},this.onPopState);var c=this;setTimeout(function(){c.check()},500)}},b.Deeplinking.prototype.destroy=function(){this.grid.options.deeplinking&&window.history&&a(window).off("popstate",this.onPopState)},b.Deeplinking.prototype.onPopState=function(a){a.data.self.check()},b.Deeplinking.prototype.hash=function(a){return["#!"+this.grid.options.deeplinkingPrefix,this.grid.id,e.fnv1a(a)].join("/")},b.Deeplinking.prototype.check=function(){var b=this,c=location.hash,e="#!"+b.grid.options.deeplinkingPrefix+"/";if(d.string(c)&&c.length>=e.length&&c.substr(0,e.length)===e){var f=c.split("/");if(3===f.length){var g=f[1];b.grid.id==g&&a.each(b.grid.items,function(a,d){if(d.hash==c)return b.grid.content.open(d.index),!1})}}},b.Deeplinking.prototype.clear=function(){this.grid.options.deeplinking&&window.history&&history.replaceState(null,"",location.href.split("#")[0])},b.Deeplinking.prototype.set=function(a){this.grid.options.deeplinking&&window.history&&history.replaceState(null,a.content.title,a.hash)};var f=b.Content.prototype._open;b.Content.prototype._open=function(a,b,c){var d=this;return f.call(d,a,b,c).then(function(){d.grid.deeplinking.set(a)})};var g=b.Content.prototype.close;b.Content.prototype.close=function(a,b){var c=this;return g.call(c,a,b).then(function(){c.grid.deeplinking.clear()})};var h=b.Item.prototype._init;b.Item.prototype._init=function(a,b,c){h.call(this,a,b,c),this.hash=this.grid.deeplinking.hash(this.content.external)}}}(FooGallery.$,FooGallery.FooGrid,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.str),function(a,b,c){b.FooGridTemplate=b.Template.extend({construct:function(a,b){this._super(a,b),this.wasActive=!1},onPreInit:function(a,c){c.foogrid=new b.FooGrid(c.$el.get(0),c.template,c)},onInit:function(a,b){b.foogrid.init()},onPostInit:function(a,b){b.foogrid.layout()},onReady:function(a,b){b.foogrid.layout()},onDestroy:function(a,b){b.foogrid.destroy()},onBeforePageChange:function(a,b,c,d,e){a.preventDefault(),b.wasActive=b.foogrid.isActive(),b.foogrid.close().then(function(){e(),b.loadAvailable()})},onAfterPageChange:function(a,b){b.foogrid.layout(!0),b.wasActive&&(b.wasActive=!1,b.foogrid.open(0))}}),b.template.register("foogrid",b.FooGridTemplate,null,{container:"foogallery foogrid"})}(FooGallery.$,FooGallery,FooGallery.utils);