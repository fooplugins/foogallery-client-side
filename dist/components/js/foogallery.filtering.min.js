/*
* FooGallery - The Most Intuitive and Extensible Gallery Creation and Management Tool Ever Created for WordPress
* @version 2.0.22
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/

!function(a,b,c,d){a.FilteringFactory=a.Factory.extend({construct:function(){this.registered={}},register:function(a,c,d,e,f,g,h){var i=this,j=i._super(a,c,h);if(j){var k=i.registered;k[a].ctrl=b.fn(d)?d:null,k[a].opt=b.hash(e)?e:{},k[a].cls=b.hash(f)?f:{},k[a].il8n=b.hash(g)?g:{}}return j},type:function(a){var c,d=this;return b.hash(a)&&b.hash(c=a.filtering)&&b.string(c.type)&&d.contains(c.type)?c.type:null},merge:function(a){a=d.extend({},a);var c=this,e=c.type(a),f=c.registered,g=f.default.opt,h=f.default.cls,i=f.default.il8n,j=b.hash(a.filtering)?a.filtering:{},k=b.hash(a.cls)&&b.hash(a.cls.filtering)?d.extend({},a.cls.filtering):{},l=b.hash(a.il8n)&&b.hash(a.il8n.filtering)?d.extend({},a.il8n.filtering):{};return b.hash(a.cls)||(a.cls={}),b.hash(a.il8n)||(a.il8n={}),"default"!==e&&c.contains(e)?(a.filtering=d.extend({},g,f[e].opt,j,{type:e}),a.cls=d.extend(a.cls,{filtering:h},{filtering:f[e].cls},{filtering:k}),a.il8n=d.extend(a.il8n,{filtering:i},{filtering:f[e].il8n},{filtering:l})):(a.filtering=d.extend({},g,j,{type:e}),a.cls=d.extend(a.cls,{filtering:h},{filtering:k}),a.il8n=d.extend(a.il8n,{filtering:i},{filtering:l})),a},configure:function(a,b,c,e){var f=this;if(f.contains(a)){var g=f.registered;d.extend(g[a].opt,b),d.extend(g[a].cls,c),d.extend(g[a].il8n,e)}},hasCtrl:function(a){var c=this,d=c.registered[a];return b.hash(d)&&b.fn(d.ctrl)},makeCtrl:function(a,c,d,e){var f=this,g=f.registered[a];return b.hash(g)&&b.fn(g.ctrl)?new g.ctrl(c,d,e):null}}),a.filtering=new a.FilteringFactory}(FooGallery,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.obj),function(a,b,c,d,e){b.Filtering=b.Component.extend({construct:function(a){var b=this;b._super(a),b.opt=b.tmpl.opt.filtering,b.cls=b.tmpl.cls.filtering,b.il8n=b.tmpl.il8n.filtering,b.sel=b.tmpl.sel.filtering,b.pushOrReplace=b.opt.pushOrReplace,b.type=b.opt.type,b.theme=b.opt.theme,b.position=b.opt.position,b.mode=b.opt.mode,b.sortBy=b.opt.sortBy,b.sortInvert=b.opt.sortInvert,b.min=b.opt.min,b.limit=b.opt.limit,b.showCount=b.opt.showCount,b.adjustSize=b.opt.adjustSize,b.smallest=b.opt.smallest,b.largest=b.opt.largest,b.adjustOpacity=b.opt.adjustOpacity,b.lightest=b.opt.lightest,b.darkest=b.opt.darkest,b.current=[],b.ctrls=[],b.tags=[],b.search="",b.isMultiLevel=!1},fromHash:function(a){var b=this,c=b.tmpl.state.opt;return a.split(c.arraySeparator).map(function(a){return d.empty(a)?[]:a.split(c.array).map(function(a){return decodeURIComponent(a)})})},toHash:function(b){var c=this,e=c.tmpl.state.opt,f=null;return d.array(b)&&(f=a.map(b,function(b){return(d.array(b)?a.map(b,function(a){return d.undef(a)?"":encodeURIComponent(a)}):[]).join(e.array)}).join(e.arraySeparator)),d.empty(f)?null:f},getState:function(){return d.array(this.current)&&!this.current.every(function(a){return 0===a.length})?this.current.slice():null},setState:function(a){this.rebuild(),this.set(a.filter,"",!1)},destroy:function(){var b=this;b.tags.splice(0,b.tags.length),a.each(b.ctrls.splice(0,b.ctrls.length),function(a,b){b.destroy()}),b._super()},count:function(a,b){a=d.array(a)?a:[],b=d.array(b)?b:[];for(var e,f={__ALL__:0},g=0===b.length,h=0,i=a.length;h<i;h++)if(!d.empty(e=a[h].tags)){f.__ALL__++;for(var j,k=0,l=e.length;k<l;k++)d.empty(j=e[k])||!g&&(g||-1===c.inArray(j,b))||(d.number(f[j])?f[j]++:f[j]=1)}for(var m=0,n=b.length;m<n;m++)f.hasOwnProperty(b[m])||(f[b[m]]=0);return f},createTagObjects:function(a,b,d,e){var f=this,g=[],h=f.count(a,b),i=1/0,j=0,k=-1;if(0===h.__ALL__)return g;for(var l in h)if(h.hasOwnProperty(l)){var m=h[l],n="__ALL__"===l;(f.min<=0||m>=f.min)&&(b.length>0?k=c.inArray(l,b):k++,g.push({level:d,index:k,value:n?"":l,text:n?e:l,count:m,percent:1,size:f.largest,opacity:f.darkest}),m<i&&(i=m),m>j&&(j=m))}if(f.limit>0&&g.length>f.limit&&(g.sort(function(a,b){return b.count-a.count}),g=g.slice(0,f.limit)),!f.isMultiLevel&&(!0===f.adjustSize||!0===f.adjustOpacity))for(var o,p=f.largest-f.smallest,q=f.darkest-f.lightest,r=0,s=g.length;r<s;r++)o=g[r],o.percent=(o.count-i)/(j-i),o.size=f.adjustSize?Math.round(p*o.percent+f.smallest):f.largest,o.opacity=f.adjustOpacity?q*o.percent+f.lightest:f.darkest;switch(f.sortBy){case"none":f.sort(g,"index",!1);break;default:f.sort(g,f.sortBy,f.sortInvert)}return g},showControl:function(){return this.opt.search||!this.tags.every(function(a){return 0===a.length})},build:function(c){var e=this,f=c?e.tmpl.items.available():e.tmpl.items.all();if(e.isMultiLevel=e.opt.tags.length>0&&d.object(e.opt.tags[0]),f.length>0){var g;e.isMultiLevel?a.each(e.opt.tags,function(a,b){g=e.createTagObjects(f,b.tags,a,b.all||e.il8n.all),d.empty(g)||e.tags.push(g)}):(g=e.createTagObjects(f,e.opt.tags,0,e.il8n.all),d.empty(g)||e.tags.push(g))}if(e.showControl()&&b.filtering.hasCtrl(e.type)){var h,i,j=e.position;"both"!==j&&"top"!==j||(h=b.filtering.makeCtrl(e.type,e.tmpl,e,"top"),h.create()&&(h.append(),e.ctrls.push(h))),"both"!==j&&"bottom"!==j||(i=b.filtering.makeCtrl(e.type,e.tmpl,e,"bottom"),i.create()&&(i.append(),e.ctrls.push(i)))}},rebuild:function(b){var c=this;c.tags.splice(0,c.tags.length),a.each(c.ctrls.splice(0,c.ctrls.length),function(a,b){b.destroy()}),c.build(b)},controls:function(b,c){var d=this;a.each(d.ctrls,function(a,d){d.update(b,c)})},hasAll:function(a,b){return b.every(function(b){return 0===b.length||d.array(a.tags)&&b.every(function(b){return-1!==a.tags.indexOf(b)})})},hasSome:function(a,b){return b.every(function(b){return 0===b.length||d.array(a.tags)&&b.some(function(b){return-1!==a.tags.indexOf(b)})})},isMatch:function(a,b){return d.string(a.title)&&b.test(a.title)||d.string(a.alt)&&b.test(a.alt)||d.string(a.caption)&&b.test(a.caption)||d.string(a.description)&&b.test(a.description)||d.array(a.tags)&&a.tags.some(function(a){return b.test(a)})},set:function(b,c,f){d.string(b)&&(b=[[b]]),d.array(b)||(b=[]);var g,h=this;if(!h.arraysEqual(h.current,b)||h.search!==c){var i=h.current.slice(),j=function(){(f=!d.boolean(f)||f)&&!h.tmpl.state.exists()&&(g=h.tmpl.state.get(),h.tmpl.state.update(g,h.pushOrReplace));var j=h.search!==c,k=d.empty(c);if(d.empty(b)&&k)h.tmpl.items.reset();else{var l=h.tmpl.items.all();if(!k){var m=new RegExp(e.escapeRegExp(c),"i");l=a.map(l,function(a){return h.isMatch(a,m)?a:null})}l="intersect"===h.mode?a.map(l,function(a){return h.hasAll(a,b)?a:null}):a.map(l,function(a){return h.hasSome(a,b)?a:null}),h.tmpl.items.setAvailable(l)}h.current=b.slice(),h.search=c,j?h.rebuild(!k):h.controls(h.current,h.search),h.tmpl.pages?(h.tmpl.pages.rebuild(),h.tmpl.pages.set(1,null,null,!0)):(h.tmpl.items.detach(h.tmpl.items.all()),h.tmpl.items.create(h.tmpl.getAvailable(),!0)),f&&(g=h.tmpl.state.get(),h.tmpl.state.update(g,h.pushOrReplace)),h.tmpl.trigger("after-filter-change",[h.current,i])};return!h.tmpl.trigger("before-filter-change",[h.current,b,j]).isDefaultPrevented()&&(j(),!0)}return!1},arraysEqual:function(a,b){if(a.length!==b.length)return!1;a=a.slice(),b=b.slice(),a.sort(),b.sort();for(var c=a.length;c--;)if(a[c]!==b[c])return!1;return!0},sort:function(a,b,c){a.sort(function(a,e){if(a.hasOwnProperty(b)&&e.hasOwnProperty(b)){if(!d.string(a[b])||!d.string(e[b]))return c?e[b]-a[b]:a[b]-e[b];var f=a[b].toUpperCase(),g=e[b].toUpperCase();if(c){if(g<f)return-1;if(g>f)return 1}else{if(f<g)return-1;if(f>g)return 1}}return 0})},apply:function(a,b){var c=this;c.set(a,b,!c.tmpl.pages)}}),b.FilteringControl=b.Component.extend({construct:function(a,b,c){var d=this;d._super(a),d.filter=b,d.position=c,d.$container=null},create:function(){var b=this;return b.$container=a("#"+b.tmpl.id+"_filtering-"+b.position),b.$container.length>0?(b._containerExisted=!0,b.$container.removeClass(function(a,c){return b._placeholderClasses=c.match(/(^|\s)fg-ph-\S+/g)||[],b._placeholderClasses.join(" ")}).addClass([b.filter.cls.container,b.filter.theme].join(" "))):b.$container=a("<nav/>",{class:[b.filter.cls.container,b.filter.theme].join(" ")}),!0},destroy:function(){var a=this;a._containerExisted?a.$container.empty().removeClass().addClass(a._placeholderClasses.join(" ")):a.$container.remove(),a.$container=null},append:function(){var a=this;a._containerExisted||("top"===a.position?a.$container.insertBefore(a.tmpl.$el):a.$container.insertAfter(a.tmpl.$el))},update:function(a){}}),b.filtering.register("default",b.Filtering,null,{type:"none",theme:"fg-light",pushOrReplace:"push",position:"none",mode:"single",sortBy:"value",sortInvert:!1,search:!1,tags:[],min:0,limit:0,showCount:!1,adjustSize:!1,adjustOpacity:!1,smallest:12,largest:16,lightest:.5,darkest:1},{container:"fg-filtering-container"},null,-100)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.str),function(a,b,c,d){b.Tags=b.Filtering.extend({}),b.TagsControl=b.FilteringControl.extend({construct:function(a,b,c){this._super(a,b,c),this.$container=null,this.searchEnabled="top"===this.position&&this.filter.opt.search,this.search={$wrap:null,$inner:null,$input:null,$clear:null,$submit:null},this.lists=[]},create:function(){var a=this;if(a._super()){var b=a.filter.cls;if(a.searchEnabled&&(a.$container.append(a.createSearch(a.filter.search)),d.empty(a.filter.opt.searchPosition)||a.$container.addClass("fg-search-"+a.filter.opt.searchPosition)),a.filter.tags.length>0){for(var c=0,e=a.filter.tags.length;c<e;c++)a.lists.push(a.createList(a.filter.tags[c]).appendTo(a.$container));a.filter.isMultiLevel||!0!==a.filter.showCount||a.$container.addClass(b.showCount)}else a.$container.addClass(b.noTags);return!0}return!1},createSearch:function(c){var e=this,f=e.filter.cls.search,g=e.filter.il8n;return e.search.$wrap=a("<div/>",{class:f.wrap}),e.search.$inner=a("<div/>",{class:f.inner}).appendTo(e.search.$wrap),e.search.$input=a("<input/>",{type:"text",class:f.input,placeholder:g.searchPlaceholder}).on("input.foogallery",{self:e},e.onSearchInput).on("keydown.foogallery",{self:e},e.onSearchKeydown).appendTo(e.search.$inner),e.search.$clear=a("<button/>",{type:"button",class:f.clear}).append(a("<span/>",{class:f.reader,text:g.searchClear})).append(b.icons.get("close")).on("click.foogallery",{self:e},e.onSearchClear).appendTo(e.search.$inner),e.search.$submit=a("<button/>",{type:"button",class:f.submit}).append(a("<span/>",{class:f.reader,text:g.searchSubmit})).append(b.icons.get("search")).on("click.foogallery",{self:e},e.onSearchSubmit).appendTo(e.search.$inner),d.empty(c)||(e.search.$wrap.addClass(f.hasValue),e.search.$input.val(c).attr("placeholder",c)),e.search.$wrap},createList:function(b){for(var c=this,d=c.filter.cls,e=a("<ul/>",{class:d.list}),f=0,g=b.length;f<g;f++)e.append(c.createItem(b[f]).toggleClass(d.selected,0===f));return e},destroy:function(){var a=this,b=a.filter.sel;a.lists.forEach(function(c,d){c.find(b.link).off("click.foogallery",a.onLinkClick)}),a.lists=[],a._super()},update:function(b,e){var f=this,g=f.filter.cls,h=f.filter.sel;f.searchEnabled&&(f.search.$wrap.toggleClass(g.search.hasValue,!d.empty(e)),f.search.$input.val(e)),f.lists.forEach(function(e,f){e.find(h.item).removeClass(g.selected).each(function(){var e=a(this),h=e.data("tag")+"",i=d.empty(h),j=i&&d.empty(b[f])||!i&&-1!==c.inArray(h,b[f]);e.toggleClass(g.selected,j)})})},createItem:function(b){var c=this,e=c.filter.cls,f=a("<li/>",{class:e.item}).attr("data-tag",b.value),g=a("<span/>").addClass(e.text).html(d.string(b.text)?b.text:b.value),h=a("<a/>",{href:"#tag-"+b.value,class:e.link}).on("click.foogallery",{self:c,tag:b},c.onLinkClick).css("font-size",b.size).css("opacity",b.opacity).append(g).appendTo(f);return c.filter.isMultiLevel||!0!==c.filter.showCount||h.append(a("<span/>",{text:b.count,class:e.count})),f},onLinkClick:function(a){a.preventDefault();var b,e=a.data.self,f=a.data.tag,g=e.filter.current.map(function(a){return d.array(a)?a.slice():a});if(d.empty(f.value))g[f.level]=[];else switch(e.filter.mode){case"union":case"intersect":d.array(g[f.level])||(g[f.level]=[]),b=c.inArray(f.value,g[f.level]),-1===b?g[f.level].push(f.value):g[f.level].splice(b,1);break;case"single":default:g[f.level]=[f.value]}g.every(d.empty)&&(g=[]),e.filter.apply(g,e.filter.search)},onSearchInput:function(a){var b=a.data.self,c=b.filter.cls.search,e=!d.empty(b.search.$input.val())||b.search.$input.attr("placeholder")!==b.filter.il8n.searchPlaceholder;b.search.$wrap.toggleClass(c.hasValue,e)},onSearchKeydown:function(a){if(13===a.which){var b=a.data.self;b.filter.apply([],b.search.$input.val())}},onSearchClear:function(a){a.preventDefault();var b=a.data.self;b.search.$wrap.removeClass(b.filter.cls.search.hasValue),b.search.$input.val(""),b.search.$input.attr("placeholder")!==b.filter.il8n.searchPlaceholder&&b.filter.apply([],"")},onSearchSubmit:function(a){a.preventDefault();var b=a.data.self;b.filter.apply([],b.search.$input.val())}}),b.filtering.register("tags",b.Tags,b.TagsControl,{type:"tags",position:"top",pushOrReplace:"push",searchPosition:"above-center"},{showCount:"fg-show-count",noTags:"fg-no-tags",list:"fg-tag-list",item:"fg-tag-item",link:"fg-tag-link",text:"fg-tag-text",count:"fg-tag-count",selected:"fg-selected",search:{wrap:"fg-search-wrap",inner:"fg-search-inner",input:"fg-search-input",clear:"fg-search-clear",submit:"fg-search-submit",hasValue:"fg-search-has-value",reader:"fg-sr-only"}},{all:"All",none:"No items found.",searchPlaceholder:"Search gallery...",searchSubmit:"Submit search",searchClear:"Clear search"},-100)}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is);