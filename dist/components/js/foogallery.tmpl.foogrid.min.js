/*
* FooGallery - The Most Intuitive and Extensible Gallery Creation and Management Tool Ever Created for WordPress
* @version 2.0.11
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/

!function(a,b,c,d,e,f){b.FooGridTemplate=b.Template.extend({construct:function(a,c){var d=this;d._super(a,c),d.$section=null,d.isFirst=!1,d.disableTransitions=!1,d.panel=new b.Panel(d,d.template),d.on({"pre-init":d.onPreInit,"parsed-item":d.onParsedItem,"created-item":d.onCreatedItem,"destroy-item":d.onDestroyItem,"after-state":d.onAfterState,"before-page-change":d.onBeforePageChange,"before-filter-change":d.onBeforeFilterChange},d),d.panel.on({next:d.onPanelNext,prev:d.onPanelPrev,close:d.onPanelClose,"area-load":d.onPanelAreaLoad,"area-unload":d.onPanelAreaUnload},d)},destroy:function(a){var b=this,c=b._super.bind(b);return b.panel.destroy().then(function(){return b.$section.remove(),c(a)})},onPreInit:function(){var b=this,c=!1;if(b.$section=a("<section/>",{class:"foogrid-content"}),"none"===b.panel.opt.transition&&(b.$el.hasClass("foogrid-transition-horizontal")&&(b.panel.opt.transition="horizontal",c=!0),b.$el.hasClass("foogrid-transition-vertical")&&(b.panel.opt.transition="vertical",c=!0),b.$el.hasClass("foogrid-transition-fade")&&(b.panel.opt.transition="fade",c=!0)),(b.template.transitionOpen||b.template.transitionRow)&&(c=c||b.$el.hasClass("foogrid-transition-horizontal foogrid-transition-vertical foogrid-transition-fade"),b.template.transitionOpen=b.template.transitionOpen&&c,b.template.transitionRow=b.template.transitionRow&&c),"none"===b.panel.opt.info&&(b.$el.hasClass("foogrid-caption-below")&&(b.panel.opt.info="bottom"),b.$el.hasClass("foogrid-caption-right")&&(b.panel.opt.info="right")),b.panel.info.isEnabled()&&"default"===b.panel.info.opt.align){var d=null;b.$el.hasClass("fg-c-l")&&(d="left"),b.$el.hasClass("fg-c-c")&&(d="center"),b.$el.hasClass("fg-c-r")&&(d="right"),b.$el.hasClass("fg-c-j")&&(d="justified"),null!==d&&(b.panel.info.opt.align=d)}null===b.panel.opt.theme&&(b.panel.opt.theme=b.getCSSClass("theme")),"fg-light"===b.panel.opt.theme&&null===b.panel.opt.button&&(b.panel.opt.button="fg-button-blue"),"fg-dark"===b.panel.opt.theme&&null===b.panel.opt.button&&(b.panel.opt.button="fg-button-dark")},onParsedItem:function(a,b){b.isError||b.$anchor.off("click.foogallery").on("click.gg",{self:this,item:b},this.onAnchorClick)},onCreatedItem:function(a,b){b.isError||b.$anchor.off("click.foogallery").on("click.gg",{self:this,item:b},this.onAnchorClick)},onDestroyItem:function(a,b){b.isError||b.$anchor.off("click.gg",this.onAnchorClick)},onAfterState:function(a,c){c.item instanceof b.Item&&this.open(c.item)},onBeforePageChange:function(a,b,c,d,e){if(!e){var f=this;f.panel.isMaximized||f.close(!0,f.panel.isAttached)}},onBeforeFilterChange:function(){var a=this;a.panel.isMaximized||a.close(!0,a.panel.isAttached)},onPanelNext:function(a,b,c){a.preventDefault(),this.open(c)},onPanelPrev:function(a,b,c){a.preventDefault(),this.open(c)},onPanelClose:function(a){a.preventDefault(),this.close(!1,!0)},onPanelAreaLoad:function(a,b,c){"content"===b.name&&c.item.$el.addClass(this.cls.visible)},onPanelAreaUnload:function(a,b,c){"content"===b.name&&c.item.$el.removeClass(this.cls.visible)},onAnchorClick:function(a){a.preventDefault(),a.data.self.toggle(a.data.item)},transitionsEnabled:function(){return!this.disableTransitions&&this.panel.hasTransition},isNewRow:function(a){var b=this;return b.getOffsetTop(b.panel.currentItem)!==b.getOffsetTop(a)},getOffsetTop:function(a){return a instanceof b.Item&&a.isCreated?a.$el.offset().top:0},scrollTo:function(b,d,e){var f=this;b=(c.number(b)?b:0)-+f.template.scrollOffset,d=!c.boolean(d)||d,e=c.number(e)?e:300;var g=a("#wpadminbar"),h=a("html, body");return 1===g.length&&(b-=g.height()),a.Deferred(function(a){f.template.scroll&&d?f.template.scrollSmooth&&!f.panel.isMaximized?h.animate({scrollTop:b},e,function(){a.resolve()}):(h.scrollTop(b),a.resolve()):a.resolve()})},open:function(c){var d=this;if(-1!==c.index){var e=d.isNewRow(c);return d.panel.currentItem instanceof b.Item&&e&&!d.panel.isMaximized?d.doClose(e).then(function(){return d.pages&&!d.pages.contains(d.pages.current,c)&&d.pages.goto(d.pages.find(c)),d.doOpen(c,e)}):(d.pages&&!d.pages.contains(d.pages.current,c)&&d.pages.goto(d.pages.find(c)),d.doOpen(c,e))}return a.when()},doOpen:function(b,c){var d=this;return a.Deferred(function(a){d.scrollTo(d.getOffsetTop(b),c||d.isFirst).then(function(){d.panel.appendTo(d.$section),c&&b.$el.after(d.$section),d.transitionOpen(c)?(d.isFirst=!1,f.start(d.$section,function(a){a.addClass(d.cls.visible)},null,350).then(function(){a.resolve()},function(b){a.reject(b)})):(d.$section.addClass(d.cls.visible),a.resolve())})}).then(function(){return d.scrollTo(d.getOffsetTop(b),!0)}).then(function(){return d.panel.load(b)}).then(function(){d.$section.trigger("focus")}).always(function(){d.isBusy=!1}).promise()},transitionOpen:function(a){return this.transitionsEnabled()&&!this.panel.isMaximized&&(this.template.transitionOpen&&this.isFirst||this.template.transitionRow&&a)},close:function(a,b){a=!!c.boolean(a)&&a;var d=this,e=d.disableTransitions;return d.disableTransitions=a,d.doClose(b).then(function(){d.disableTransitions=e})},doClose:function(c){var d=this;return a.Deferred(function(a){d.panel.currentItem instanceof b.Item?(d.panel.currentItem.$el.removeClass(d.cls.visible),d.transitionClose(c)?f.start(d.$section,function(a){a.removeClass(d.cls.visible)},null,350).then(function(){d.panel.doClose(!0,!0).then(function(){a.resolve()},function(b){a.reject(b)})},function(b){a.reject(b)}):(d.$section.removeClass(d.cls.visible),d.panel.doClose(!0,!0).then(function(){a.resolve()},function(b){a.reject(b)}))):a.resolve()}).always(function(){d.$section.detach(),d.isFirst=!0}).promise()},transitionClose:function(a){return this.transitionsEnabled()&&!this.panel.isMaximized&&(this.template.transitionRow&&a||this.template.transitionOpen&&!a)},toggle:function(a){var c=this;return a instanceof b.Item?c.panel.currentItem===a?c.close():c.open(a):d.reject()}}),b.template.register("foogrid",b.FooGridTemplate,{template:{classNames:"foogrid-panel",scroll:!0,scrollOffset:0,scrollSmooth:!1,loop:!0,external:"_blank",externalText:null,keyboard:!0,transitionRow:!0,transitionOpen:!0,noMobile:!0,info:"bottom",infoVisible:!0,infoOverlay:!1,buttons:{fullscreen:!1}}},{container:"foogallery foogrid",visible:"foogrid-visible"})}(FooGallery.$,FooGallery,FooGallery.utils.is,FooGallery.utils.fn,FooGallery.utils.obj,FooGallery.utils.transition);