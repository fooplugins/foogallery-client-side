/*
* FooGallery - The Most Intuitive and Extensible Gallery Creation and Management Tool Ever Created for WordPress
* @version 2.1.0
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/
!function(a,o,l,n,i){o.FooGridTemplate=o.Template.extend({construct:function(e,n){var t=this;t._super(e,n),t.$section=null,t.isFirst=!1,t.disableTransitions=!1,t.panel=new o.Panel(t,t.template),t.on({"pre-init":t.onPreInit,"parsed-item":t.onParsedItem,"created-item":t.onCreatedItem,"destroy-item":t.onDestroyItem,"after-state":t.onAfterState,"before-page-change":t.onBeforePageChange,"before-filter-change":t.onBeforeFilterChange},t),t.panel.on({next:t.onPanelNext,prev:t.onPanelPrev,close:t.onPanelClose,"area-load":t.onPanelAreaLoad,"area-unload":t.onPanelAreaUnload},t)},destroy:function(e){var n=this,t=n._super.bind(n);return n.panel.destroy().then(function(){return n.$section.remove(),t(e)})},onPreInit:function(){var e=this,n=!1;e.$section=a("<section/>",{class:"foogrid-content"}),"none"===e.panel.opt.transition&&(e.$el.hasClass("foogrid-transition-horizontal")&&(e.panel.opt.transition="horizontal",n=!0),e.$el.hasClass("foogrid-transition-vertical")&&(e.panel.opt.transition="vertical",n=!0),e.$el.hasClass("foogrid-transition-fade")&&(e.panel.opt.transition="fade",n=!0)),(e.template.transitionOpen||e.template.transitionRow)&&(n=n||e.$el.hasClass("foogrid-transition-horizontal foogrid-transition-vertical foogrid-transition-fade"),e.template.transitionOpen=e.template.transitionOpen&&n,e.template.transitionRow=e.template.transitionRow&&n),"none"===e.panel.opt.info&&(e.$el.hasClass("foogrid-caption-below")&&(e.panel.opt.info="bottom"),e.$el.hasClass("foogrid-caption-right")&&(e.panel.opt.info="right")),e.panel.info.isEnabled()&&"default"===e.panel.info.opt.align&&(n=null,e.$el.hasClass("fg-c-l")&&(n="left"),e.$el.hasClass("fg-c-c")&&(n="center"),e.$el.hasClass("fg-c-r")&&(n="right"),null!==(n=e.$el.hasClass("fg-c-j")?"justified":n)&&(e.panel.info.opt.align=n)),null===e.panel.opt.theme&&(e.panel.opt.theme=e.getCSSClass("theme")),"fg-light"===e.panel.opt.theme&&null===e.panel.opt.button&&(e.panel.opt.button="fg-button-blue"),"fg-dark"===e.panel.opt.theme&&null===e.panel.opt.button&&(e.panel.opt.button="fg-button-dark")},onParsedItem:function(e,n){n.isError||n.$anchor.off("click.foogallery").on("click.gg",{self:this,item:n},this.onAnchorClick)},onCreatedItem:function(e,n){n.isError||n.$anchor.off("click.foogallery").on("click.gg",{self:this,item:n},this.onAnchorClick)},onDestroyItem:function(e,n){n.isError||n.$anchor.off("click.gg",this.onAnchorClick)},onAfterState:function(e,n){n.item instanceof o.Item&&this.open(n.item)},onBeforePageChange:function(e,n,t,o,i){i||((i=this).panel.isMaximized||i.close(!0,i.panel.isAttached))},onBeforeFilterChange:function(){var e=this;e.panel.isMaximized||e.close(!0,e.panel.isAttached)},onPanelNext:function(e,n,t){e.preventDefault(),this.open(t)},onPanelPrev:function(e,n,t){e.preventDefault(),this.open(t)},onPanelClose:function(e){e.preventDefault(),this.close(!1,!0)},onPanelAreaLoad:function(e,n,t){"content"===n.name&&t.item.$el.addClass(this.cls.visible)},onPanelAreaUnload:function(e,n,t){"content"===n.name&&t.item.$el.removeClass(this.cls.visible)},onAnchorClick:function(e){e.preventDefault(),e.data.self.toggle(e.data.item)},transitionsEnabled:function(){return!this.disableTransitions&&this.panel.hasTransition},isNewRow:function(e){var n=this;return n.getOffsetTop(n.panel.currentItem)!==n.getOffsetTop(e)},getOffsetTop:function(e){return e instanceof o.Item&&e.isCreated?e.$el.offset().top:0},scrollTo:function(n,t,o){var i=this,e=(n=(l.number(n)?n:0)-+i.template.scrollOffset,t=!l.boolean(t)||t,o=l.number(o)?o:300,a("#wpadminbar")),s=a("html, body");return 1===e.length&&(n-=e.height()),a.Deferred(function(e){i.template.scroll&&t?i.template.scrollSmooth&&!i.panel.isMaximized?s.animate({scrollTop:n},o,function(){e.resolve()}):(s.scrollTop(n),e.resolve()):e.resolve()})},open:function(e){var n,t=this;return-1!==e.index?(n=t.isNewRow(e),t.panel.currentItem instanceof o.Item&&n&&!t.panel.isMaximized?t.doClose(n).then(function(){return t.pages&&!t.pages.contains(t.pages.current,e)&&t.pages.goto(t.pages.find(e)),t.doOpen(e,n)}):(t.pages&&!t.pages.contains(t.pages.current,e)&&t.pages.goto(t.pages.find(e)),t.doOpen(e,n))):a.when()},doOpen:function(e,t){var o=this;return a.Deferred(function(n){o.scrollTo(o.getOffsetTop(e),t||o.isFirst).then(function(){o.panel.appendTo(o.$section),t&&e.$el.after(o.$section),o.transitionOpen(t)?(o.isFirst=!1,i.start(o.$section,function(e){e.addClass(o.cls.visible)},null,350).then(function(){n.resolve()},function(e){n.reject(e)})):(o.$section.addClass(o.cls.visible),n.resolve())})}).then(function(){return o.scrollTo(o.getOffsetTop(e),!0)}).then(function(){return o.panel.load(e)}).then(function(){o.$section.trigger("focus")}).always(function(){o.isBusy=!1}).promise()},transitionOpen:function(e){return this.transitionsEnabled()&&!this.panel.isMaximized&&(this.template.transitionOpen&&this.isFirst||this.template.transitionRow&&e)},close:function(e,n){e=!!l.boolean(e)&&e;var t=this,o=t.disableTransitions;return t.disableTransitions=e,t.doClose(n).then(function(){t.disableTransitions=o})},doClose:function(e){var t=this;return a.Deferred(function(n){t.panel.currentItem instanceof o.Item?(t.panel.currentItem.$el.removeClass(t.cls.visible),t.transitionClose(e)?i.start(t.$section,function(e){e.removeClass(t.cls.visible)},null,350).then(function(){t.panel.doClose(!0,!0).then(function(){n.resolve()},function(e){n.reject(e)})},function(e){n.reject(e)}):(t.$section.removeClass(t.cls.visible),t.panel.doClose(!0,!0).then(function(){n.resolve()},function(e){n.reject(e)}))):n.resolve()}).always(function(){t.$section.detach(),t.isFirst=!0}).promise()},transitionClose:function(e){return this.transitionsEnabled()&&!this.panel.isMaximized&&(this.template.transitionRow&&e||this.template.transitionOpen&&!e)},toggle:function(e){return e instanceof o.Item?this.panel.currentItem===e?this.close():this.open(e):n.reject()}}),o.template.register("foogrid",o.FooGridTemplate,{template:{classNames:"foogrid-panel",scroll:!0,scrollOffset:0,scrollSmooth:!1,loop:!0,external:"_blank",externalText:null,keyboard:!0,transitionRow:!0,transitionOpen:!0,noMobile:!0,info:"bottom",infoVisible:!0,infoOverlay:!1,infoAutoHide:!1,buttons:{fullscreen:!1}}},{container:"foogallery foogrid",visible:"foogrid-visible"})}(FooGallery.$,FooGallery,FooGallery.utils.is,FooGallery.utils.fn,(FooGallery.utils.obj,FooGallery.utils.transition));