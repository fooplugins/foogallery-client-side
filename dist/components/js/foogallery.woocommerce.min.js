/*
* FooGallery - The Most Intuitive and Extensible Gallery Creation and Management Tool Ever Created for WordPress
* @version 2.0.21
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/

!function(a,b,c,d,e,f){b.template.configure("core",{},{woo:{button:"fg-woo-add-to-cart-ajax",disabled:"fg-disabled",added:"fg-woo-added",adding:"fg-woo-adding"}}),b.Item.prototype.onAddToCart=function(b){var c=b.data.self,d=a(this);if(!f)return void console.log("woocommerce_params not found!");var e=c.tmpl.cls.woo;if(b.preventDefault(),d.hasClass(e.disabled))return!1;var g=d.attr("data-variation-id")||c.productId,h=d.attr("data-quantity")||1;return d.removeClass(e.added).addClass(e.adding).addClass(e.disabled),c.addToCart(d,g,h,!0).then(function(){d.removeClass(e.adding).removeClass(e.disabled).addClass(e.added)}),!1},b.Item.prototype.addToCart=function(b,c,e,g){var h=this,i=a(document.body),j="?add-to-cart="+c,k=[{name:"product_id",value:c},{name:"quantity",value:e},{name:"foogallery_attachment_id",value:h.id},{name:"foogallery_id",value:h.tmpl.id}];return i.trigger("adding_to_cart",[b,k]),a.ajax({type:"POST",url:f.wc_ajax_url.toString().replace("%%endpoint%%","add_to_cart"),data:k}).then(function(a){return a?a.error?g&&(d.string(a.product_url)&&(window.location=a.product_url),window.location=j):i.trigger("added_to_cart",[a.fragments,a.cart_hash]):console.log("An unexpected response was returned from the server.",a),a},function(a,b,c){console.log("FooGallery: Add to cart ajax error.",a,b,c),g&&(window.location=j)})},b.Item.override("doParseItem",function(a){var b=this;return!!b._super(a)&&(a.find(b.tmpl.sel.woo.button).on("click.foogallery",{self:b},b.onAddToCart),!0)}),b.Item.override("doCreateItem",function(){var a=this;return!!a._super()&&(a.$el.find(a.tmpl.sel.woo.button).on("click.foogallery",{self:a},a.onAddToCart),!0)}),b.Item.override("doDestroyItem",function(){var a=this;return a.isParsed&&a.$el.find(a.tmpl.sel.woo.button).off("click.foogallery"),a._super()})}(FooGallery.$,FooGallery,FooGallery.utils,FooGallery.utils.is,FooGallery.utils.obj,window.woocommerce_params);